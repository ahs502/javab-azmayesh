!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.d3=e.d3||{})}(this,function(e){"use strict";function t(e,t){var n=Object.create(e.prototype);for(var o in t)n[o]=t[o];return n}function n(){}function o(e){var t;return e=(e+"").trim().toLowerCase(),(t=I.exec(e))?(t=parseInt(t[1],16),new l(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1)):(t=D.exec(e))?r(parseInt(t[1],16)):(t=k.exec(e))?new l(t[1],t[2],t[3],1):(t=T.exec(e))?new l(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=E.exec(e))?a(t[1],t[2],t[3],t[4]):(t=H.exec(e))?a(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=j.exec(e))?u(t[1],t[2]/100,t[3]/100,1):(t=z.exec(e))?u(t[1],t[2]/100,t[3]/100,t[4]):V.hasOwnProperty(e)?r(V[e]):"transparent"===e?new l(NaN,NaN,NaN,0):null}function r(e){return new l(e>>16&255,e>>8&255,255&e,1)}function a(e,t,n,o){return o<=0&&(e=t=n=NaN),new l(e,t,n,o)}function i(e){return e instanceof n||(e=o(e)),e?(e=e.rgb(),new l(e.r,e.g,e.b,e.opacity)):new l}function s(e,t,n,o){return 1===arguments.length?i(e):new l(e,t,n,null==o?1:o)}function l(e,t,n,o){this.r=+e,this.g=+t,this.b=+n,this.opacity=+o}function u(e,t,n,o){return o<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new f(e,t,n,o)}function c(e){if(e instanceof f)return new f(e.h,e.s,e.l,e.opacity);if(e instanceof n||(e=o(e)),!e)return new f;if(e instanceof f)return e;e=e.rgb();var t=e.r/255,r=e.g/255,a=e.b/255,i=Math.min(t,r,a),s=Math.max(t,r,a),l=NaN,u=s-i,c=(s+i)/2;return u?(l=t===s?(r-a)/u+6*(r<a):r===s?(a-t)/u+2:(t-r)/u+4,u/=c<.5?s+i:2-s-i,l*=60):u=c>0&&c<1?0:l,new f(l,u,c,e.opacity)}function d(e,t,n,o){return 1===arguments.length?c(e):new f(e,t,n,null==o?1:o)}function f(e,t,n,o){this.h=+e,this.s=+t,this.l=+n,this.opacity=+o}function m(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function p(e){if(e instanceof g)return new g(e.l,e.a,e.b,e.opacity);if(e instanceof P){var t=e.h*U;return new g(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}e instanceof l||(e=i(e));var n=w(e.r),o=w(e.g),r=w(e.b),a=v((.4124564*n+.3575761*o+.1804375*r)/F),s=v((.2126729*n+.7151522*o+.072175*r)/R);return new g(116*s-16,500*(a-s),200*(s-v((.0193339*n+.119192*o+.9503041*r)/B)),e.opacity)}function h(e,t,n,o){return 1===arguments.length?p(e):new g(e,t,n,null==o?1:o)}function g(e,t,n,o){this.l=+e,this.a=+t,this.b=+n,this.opacity=+o}function v(e){return e>Y?Math.pow(e,1/3):e/Q+q}function y(e){return e>Z?e*e*e:Q*(e-q)}function b(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function w(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function S(e){if(e instanceof P)return new P(e.h,e.c,e.l,e.opacity);e instanceof g||(e=p(e));var t=Math.atan2(e.b,e.a)*O;return new P(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function C(e,t,n,o){return 1===arguments.length?S(e):new P(e,t,n,null==o?1:o)}function P(e,t,n,o){this.h=+e,this.c=+t,this.l=+n,this.opacity=+o}function N(e){if(e instanceof x)return new x(e.h,e.s,e.l,e.opacity);e instanceof l||(e=i(e));var t=e.r/255,n=e.g/255,o=e.b/255,r=(ne*o+ee*t-te*n)/(ne+ee-te),a=o-r,s=(K*(n-r)-X*a)/W,u=Math.sqrt(s*s+a*a)/(K*r*(1-r)),c=u?Math.atan2(s,a)*O-120:NaN;return new x(c<0?c+360:c,u,r,e.opacity)}function M(e,t,n,o){return 1===arguments.length?N(e):new x(e,t,n,null==o?1:o)}function x(e,t,n,o){this.h=+e,this.s=+t,this.l=+n,this.opacity=+o}var _=function(e,t,n){e.prototype=t.prototype=n,n.constructor=e},A="\\s*([+-]?\\d+)\\s*",L="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",$="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",I=/^#([0-9a-f]{3})$/,D=/^#([0-9a-f]{6})$/,k=new RegExp("^rgb\\("+[A,A,A]+"\\)$"),T=new RegExp("^rgb\\("+[$,$,$]+"\\)$"),E=new RegExp("^rgba\\("+[A,A,A,L]+"\\)$"),H=new RegExp("^rgba\\("+[$,$,$,L]+"\\)$"),j=new RegExp("^hsl\\("+[L,$,$]+"\\)$"),z=new RegExp("^hsla\\("+[L,$,$,L]+"\\)$"),V={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};_(n,o,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),_(l,s,t(n,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new l(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new l(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(1===e?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}})),_(f,d,t(n,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new f(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new f(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,o=n+(n<.5?n:1-n)*t,r=2*n-o;return new l(m(e>=240?e-240:e+120,r,o),m(e,r,o),m(e<120?e+240:e-120,r,o),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var U=Math.PI/180,O=180/Math.PI,F=.95047,R=1,B=1.08883,q=4/29,Z=6/29,Q=3*Z*Z,Y=Z*Z*Z;_(g,h,t(n,{brighter:function(e){return new g(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new g(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return e=R*y(e),t=F*y(t),n=B*y(n),new l(b(3.2404542*t-1.5371385*e-.4985314*n),b(-.969266*t+1.8760108*e+.041556*n),b(.0556434*t-.2040259*e+1.0572252*n),this.opacity)}})),_(P,C,t(n,{brighter:function(e){return new P(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new P(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return p(this).rgb()}}));var G=-.14861,J=1.78277,X=-.29227,W=-.90649,K=1.97294,ee=K*W,te=K*J,ne=J*X-W*G;_(x,M,t(n,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new x(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new x(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*U,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),o=Math.cos(e),r=Math.sin(e);return new l(255*(t+n*(G*o+J*r)),255*(t+n*(X*o+W*r)),255*(t+n*(K*o)),this.opacity)}})),e.color=o,e.rgb=s,e.hsl=d,e.lab=h,e.hcl=C,e.cubehelix=M,Object.defineProperty(e,"__esModule",{value:!0})}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.d3=e.d3||{})}(this,function(e){"use strict";function t(){for(var e,t=0,o=arguments.length,r={};t<o;++t){if(!(e=arguments[t]+"")||e in r)throw new Error("illegal type: "+e);r[e]=[]}return new n(r)}function n(e){this._=e}function o(e,t){return e.trim().split(/^|\s+/).map(function(e){var n="",o=e.indexOf(".");if(o>=0&&(n=e.slice(o+1),e=e.slice(0,o)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}})}function r(e,t){for(var n,o=0,r=e.length;o<r;++o)if((n=e[o]).name===t)return n.value}function a(e,t,n){for(var o=0,r=e.length;o<r;++o)if(e[o].name===t){e[o]=i,e=e.slice(0,o).concat(e.slice(o+1));break}return null!=n&&e.push({name:t,value:n}),e}var i={value:function(){}};n.prototype=t.prototype={constructor:n,on:function(e,t){var n,i=this._,s=o(e+"",i),l=-1,u=s.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++l<u;)if(n=(e=s[l]).type)i[n]=a(i[n],e.name,t);else if(null==t)for(n in i)i[n]=a(i[n],e.name,null);return this}for(;++l<u;)if((n=(e=s[l]).type)&&(n=r(i[n],e.name)))return n},copy:function(){var e={},t=this._;for(var o in t)e[o]=t[o].slice();return new n(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,o,r=new Array(n),a=0;a<n;++a)r[a]=arguments[a+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],a=0,n=o.length;a<n;++a)o[a].value.apply(t,r)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],r=0,a=o.length;r<a;++r)o[r].value.apply(t,n)}},e.dispatch=t,Object.defineProperty(e,"__esModule",{value:!0})}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3-dispatch"),require("d3-selection")):"function"==typeof define&&define.amd?define(["exports","d3-dispatch","d3-selection"],t):t(e.d3=e.d3||{},e.d3,e.d3)}(this,function(e,t,n){"use strict";function o(){n.event.stopImmediatePropagation()}function r(e,t){var o=e.document.documentElement,r=n.select(e).on("dragstart.drag",null);t&&(r.on("click.drag",u,!0),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in o?r.on("selectstart.drag",null):(o.style.MozUserSelect=o.__noselect,delete o.__noselect)}function a(e,t,n,o,r,a,i,s,l,u){this.target=e,this.type=t,this.subject=n,this.identifier=o,this.active=r,this.x=a,this.y=i,this.dx=s,this.dy=l,this._=u}function i(){return!n.event.button}function s(){return this.parentNode}function l(e){return null==e?{x:n.event.x,y:n.event.y}:e}var u=function(){n.event.preventDefault(),n.event.stopImmediatePropagation()},c=function(e){var t=e.document.documentElement,o=n.select(e).on("dragstart.drag",u,!0);"onselectstart"in t?o.on("selectstart.drag",u,!0):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")},d=function(e){return function(){return e}};a.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var f=function(){function e(e){e.on("mousedown.drag",f).on("touchstart.drag",h).on("touchmove.drag",g).on("touchend.drag touchcancel.drag",v).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function f(){if(!C&&P.apply(this,arguments)){var e=y("mouse",N.apply(this,arguments),n.mouse,this,arguments);e&&(n.select(n.event.view).on("mousemove.drag",m,!0).on("mouseup.drag",p,!0),c(n.event.view),o(),S=!1,b=n.event.clientX,w=n.event.clientY,e("start"))}}function m(){if(u(),!S){var e=n.event.clientX-b,t=n.event.clientY-w;S=e*e+t*t>L}x.mouse("drag")}function p(){n.select(n.event.view).on("mousemove.drag mouseup.drag",null),r(n.event.view,S),u(),x.mouse("end")}function h(){if(P.apply(this,arguments)){var e,t,r=n.event.changedTouches,a=N.apply(this,arguments),i=r.length;for(e=0;e<i;++e)(t=y(r[e].identifier,a,n.touch,this,arguments))&&(o(),t("start"))}}function g(){var e,t,o=n.event.changedTouches,r=o.length;for(e=0;e<r;++e)(t=x[o[e].identifier])&&(u(),t("drag"))}function v(){var e,t,r=n.event.changedTouches,a=r.length;for(C&&clearTimeout(C),C=setTimeout(function(){C=null},500),e=0;e<a;++e)(t=x[r[e].identifier])&&(o(),t("end"))}function y(t,o,r,i,s){var l,u,c,d=r(o,t),f=_.copy();if(n.customEvent(new a(e,"beforestart",l,t,A,d[0],d[1],0,0,f),function(){return null!=(n.event.subject=l=M.apply(i,s))&&(u=l.x-d[0]||0,c=l.y-d[1]||0,!0)}))return function m(p){var h,g=d;switch(p){case"start":x[t]=m,h=A++;break;case"end":delete x[t],--A;case"drag":d=r(o,t),h=A}n.customEvent(new a(e,p,l,t,h,d[0]+u,d[1]+c,d[0]-g[0],d[1]-g[1],f),f.apply,f,[p,i,s])}}var b,w,S,C,P=i,N=s,M=l,x={},_=t.dispatch("start","drag","end"),A=0,L=0;return e.filter=function(t){return arguments.length?(P="function"==typeof t?t:d(!!t),e):P},e.container=function(t){return arguments.length?(N="function"==typeof t?t:d(t),e):N},e.subject=function(t){return arguments.length?(M="function"==typeof t?t:d(t),e):M},e.on=function(){var t=_.on.apply(_,arguments);return t===_?e:t},e.clickDistance=function(t){return arguments.length?(L=(t=+t)*t,e):Math.sqrt(L)},e};e.drag=f,e.dragDisable=c,e.dragEnable=r,Object.defineProperty(e,"__esModule",{value:!0})}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.d3=e.d3||{})}(this,function(e){"use strict";function t(e){return+e}function n(e){return e*e}function o(e){return e*(2-e)}function r(e){return((e*=2)<=1?e*e:--e*(2-e)+1)/2}function a(e){return e*e*e}function i(e){return--e*e*e+1}function s(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}function l(e){return 1-Math.cos(e*N)}function u(e){return Math.sin(e*N)}function c(e){return(1-Math.cos(P*e))/2}function d(e){return Math.pow(2,10*e-10)}function f(e){return 1-Math.pow(2,-10*e)}function m(e){return((e*=2)<=1?Math.pow(2,10*e-10):2-Math.pow(2,10-10*e))/2}function p(e){return 1-Math.sqrt(1-e*e)}function h(e){return Math.sqrt(1- --e*e)}function g(e){return((e*=2)<=1?1-Math.sqrt(1-e*e):Math.sqrt(1-(e-=2)*e)+1)/2}function v(e){return 1-y(1-e)}function y(e){return(e=+e)<M?T*e*e:e<_?T*(e-=x)*e+A:e<$?T*(e-=L)*e+I:T*(e-=D)*e+k}function b(e){return((e*=2)<=1?1-y(1-e):y(e-1)+1)/2}var w=function e(t){function n(e){return Math.pow(e,t)}return t=+t,n.exponent=e,n}(3),S=function e(t){function n(e){return 1-Math.pow(1-e,t)}return t=+t,n.exponent=e,n}(3),C=function e(t){function n(e){return((e*=2)<=1?Math.pow(e,t):2-Math.pow(2-e,t))/2}return t=+t,n.exponent=e,n}(3),P=Math.PI,N=P/2,M=4/11,x=6/11,_=8/11,A=.75,L=9/11,$=10/11,I=.9375,D=21/22,k=63/64,T=1/M/M,E=function e(t){function n(e){return e*e*((t+1)*e-t)}return t=+t,n.overshoot=e,n}(1.70158),H=function e(t){function n(e){return--e*e*((t+1)*e+t)+1}return t=+t,n.overshoot=e,n}(1.70158),j=function e(t){function n(e){return((e*=2)<1?e*e*((t+1)*e-t):(e-=2)*e*((t+1)*e+t)+2)/2}return t=+t,n.overshoot=e,n}(1.70158),z=2*Math.PI,V=function e(t,n){function o(e){return t*Math.pow(2,10*--e)*Math.sin((r-e)/n)}var r=Math.asin(1/(t=Math.max(1,t)))*(n/=z);return o.amplitude=function(t){return e(t,n*z)},o.period=function(n){return e(t,n)},o}(1,.3),U=function e(t,n){function o(e){return 1-t*Math.pow(2,-10*(e=+e))*Math.sin((e+r)/n)}var r=Math.asin(1/(t=Math.max(1,t)))*(n/=z);return o.amplitude=function(t){return e(t,n*z)},o.period=function(n){return e(t,n)},o}(1,.3),O=function e(t,n){function o(e){return((e=2*e-1)<0?t*Math.pow(2,10*e)*Math.sin((r-e)/n):2-t*Math.pow(2,-10*e)*Math.sin((r+e)/n))/2}var r=Math.asin(1/(t=Math.max(1,t)))*(n/=z);return o.amplitude=function(t){return e(t,n*z)},o.period=function(n){return e(t,n)},o}(1,.3);e.easeLinear=t,e.easeQuad=r,e.easeQuadIn=n,e.easeQuadOut=o,e.easeQuadInOut=r,e.easeCubic=s,e.easeCubicIn=a,e.easeCubicOut=i,e.easeCubicInOut=s,e.easePoly=C,e.easePolyIn=w,e.easePolyOut=S,e.easePolyInOut=C,e.easeSin=c,e.easeSinIn=l,e.easeSinOut=u,e.easeSinInOut=c,e.easeExp=m,e.easeExpIn=d,e.easeExpOut=f,e.easeExpInOut=m,e.easeCircle=g,e.easeCircleIn=p,e.easeCircleOut=h,e.easeCircleInOut=g,e.easeBounce=y,e.easeBounceIn=v,e.easeBounceOut=y,e.easeBounceInOut=b,e.easeBack=j,e.easeBackIn=E,e.easeBackOut=H,e.easeBackInOut=j,e.easeElastic=U,e.easeElasticIn=V,e.easeElasticOut=U,e.easeElasticInOut=O,Object.defineProperty(e,"__esModule",{value:!0})}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3-color")):"function"==typeof define&&define.amd?define(["exports","d3-color"],t):t(e.d3=e.d3||{},e.d3)}(this,function(e,t){"use strict";function n(e,t,n,o,r){var a=e*e,i=a*e;return((1-3*e+3*a-i)*t+(4-6*a+3*i)*n+(1+3*e+3*a-3*i)*o+i*r)/6}function o(e,t){return function(n){return e+n*t}}function r(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(o){return Math.pow(e+o*t,n)}}function a(e,t){var n=t-e;return n?o(e,n>180||n<-180?n-360*Math.round(n/360):n):_(isNaN(e)?t:e)}function i(e){return 1==(e=+e)?s:function(t,n){return n-t?r(t,n,e):_(isNaN(t)?n:t)}}function s(e,t){var n=t-e;return n?o(e,n):_(isNaN(e)?t:e)}function l(e){return function(n){var o,r,a=n.length,i=new Array(a),s=new Array(a),l=new Array(a);for(o=0;o<a;++o)r=t.rgb(n[o]),i[o]=r.r||0,s[o]=r.g||0,l[o]=r.b||0;return i=e(i),s=e(s),l=e(l),r.opacity=1,function(e){return r.r=i(e),r.g=s(e),r.b=l(e),r+""}}}function u(e){return function(){return e}}function c(e){return function(t){return e(t)+""}}function d(e){return"none"===e?O:(S||(S=document.createElement("DIV"),C=document.documentElement,P=document.defaultView),S.style.transform=e,e=P.getComputedStyle(C.appendChild(S),null).getPropertyValue("transform"),C.removeChild(S),e=e.slice(7,-1).split(","),F(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5]))}function f(e){return null==e?O:(N||(N=document.createElementNS("http://www.w3.org/2000/svg","g")),N.setAttribute("transform",e),(e=N.transform.baseVal.consolidate())?(e=e.matrix,F(e.a,e.b,e.c,e.d,e.e,e.f)):O)}function m(e,t,n,o){function r(e){return e.length?e.pop()+" ":""}function a(e,o,r,a,i,s){if(e!==r||o!==a){var l=i.push("translate(",null,t,null,n);s.push({i:l-4,x:k(e,r)},{i:l-2,x:k(o,a)})}else(r||a)&&i.push("translate("+r+t+a+n)}function i(e,t,n,a){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),a.push({i:n.push(r(n)+"rotate(",null,o)-2,x:k(e,t)})):t&&n.push(r(n)+"rotate("+t+o)}function s(e,t,n,a){e!==t?a.push({i:n.push(r(n)+"skewX(",null,o)-2,x:k(e,t)}):t&&n.push(r(n)+"skewX("+t+o)}function l(e,t,n,o,a,i){if(e!==n||t!==o){var s=a.push(r(a)+"scale(",null,",",null,")");i.push({i:s-4,x:k(e,n)},{i:s-2,x:k(t,o)})}else 1===n&&1===o||a.push(r(a)+"scale("+n+","+o+")")}return function(t,n){var o=[],r=[];return t=e(t),n=e(n),a(t.translateX,t.translateY,n.translateX,n.translateY,o,r),i(t.rotate,n.rotate,o,r),s(t.skewX,n.skewX,o,r),l(t.scaleX,t.scaleY,n.scaleX,n.scaleY,o,r),t=n=null,function(e){for(var t,n=-1,a=r.length;++n<a;)o[(t=r[n]).i]=t.x(e);return o.join("")}}}function p(e){return((e=Math.exp(e))+1/e)/2}function h(e){return((e=Math.exp(e))-1/e)/2}function g(e){return((e=Math.exp(2*e))-1)/(e+1)}function v(e){return function(n,o){var r=e((n=t.hsl(n)).h,(o=t.hsl(o)).h),a=s(n.s,o.s),i=s(n.l,o.l),l=s(n.opacity,o.opacity);return function(e){return n.h=r(e),n.s=a(e),n.l=i(e),n.opacity=l(e),n+""}}}function y(e,n){var o=s((e=t.lab(e)).l,(n=t.lab(n)).l),r=s(e.a,n.a),a=s(e.b,n.b),i=s(e.opacity,n.opacity);return function(t){return e.l=o(t),e.a=r(t),e.b=a(t),e.opacity=i(t),e+""}}function b(e){return function(n,o){var r=e((n=t.hcl(n)).h,(o=t.hcl(o)).h),a=s(n.c,o.c),i=s(n.l,o.l),l=s(n.opacity,o.opacity);return function(e){return n.h=r(e),n.c=a(e),n.l=i(e),n.opacity=l(e),n+""}}}function w(e){return function n(o){function r(n,r){var a=e((n=t.cubehelix(n)).h,(r=t.cubehelix(r)).h),i=s(n.s,r.s),l=s(n.l,r.l),u=s(n.opacity,r.opacity);return function(e){return n.h=a(e),n.s=i(e),n.l=l(Math.pow(e,o)),n.opacity=u(e),n+""}}return o=+o,r.gamma=n,r}(1)}var S,C,P,N,M=function(e){var t=e.length-1;return function(o){var r=o<=0?o=0:o>=1?(o=1,t-1):Math.floor(o*t),a=e[r],i=e[r+1],s=r>0?e[r-1]:2*a-i,l=r<t-1?e[r+2]:2*i-a;return n((o-r/t)*t,s,a,i,l)}},x=function(e){var t=e.length;return function(o){var r=Math.floor(((o%=1)<0?++o:o)*t),a=e[(r+t-1)%t],i=e[r%t],s=e[(r+1)%t],l=e[(r+2)%t];return n((o-r/t)*t,a,i,s,l)}},_=function(e){return function(){return e}},A=function e(n){function o(e,n){var o=r((e=t.rgb(e)).r,(n=t.rgb(n)).r),a=r(e.g,n.g),i=r(e.b,n.b),l=s(e.opacity,n.opacity);return function(t){return e.r=o(t),e.g=a(t),e.b=i(t),e.opacity=l(t),e+""}}var r=i(n);return o.gamma=e,o}(1),L=l(M),$=l(x),I=function(e,t){var n,o=t?t.length:0,r=e?Math.min(o,e.length):0,a=new Array(o),i=new Array(o);for(n=0;n<r;++n)a[n]=z(e[n],t[n]);for(;n<o;++n)i[n]=t[n];return function(e){for(n=0;n<r;++n)i[n]=a[n](e);return i}},D=function(e,t){var n=new Date;return e=+e,t-=e,function(o){return n.setTime(e+t*o),n}},k=function(e,t){return e=+e,t-=e,function(n){return e+t*n}},T=function(e,t){var n,o={},r={};null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={});for(n in t)n in e?o[n]=z(e[n],t[n]):r[n]=t[n];return function(e){for(n in o)r[n]=o[n](e);return r}},E=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,H=new RegExp(E.source,"g"),j=function(e,t){var n,o,r,a=E.lastIndex=H.lastIndex=0,i=-1,s=[],l=[];for(e+="",t+="";(n=E.exec(e))&&(o=H.exec(t));)(r=o.index)>a&&(r=t.slice(a,r),s[i]?s[i]+=r:s[++i]=r),(n=n[0])===(o=o[0])?s[i]?s[i]+=o:s[++i]=o:(s[++i]=null,l.push({i:i,x:k(n,o)})),a=H.lastIndex;return a<t.length&&(r=t.slice(a),s[i]?s[i]+=r:s[++i]=r),s.length<2?l[0]?c(l[0].x):u(t):(t=l.length,function(e){for(var n,o=0;o<t;++o)s[(n=l[o]).i]=n.x(e);return s.join("")})},z=function(e,n){var o,r=typeof n;return null==n||"boolean"===r?_(n):("number"===r?k:"string"===r?(o=t.color(n))?(n=o,A):j:n instanceof t.color?A:n instanceof Date?D:Array.isArray(n)?I:"function"!=typeof n.valueOf&&"function"!=typeof n.toString||isNaN(n)?T:k)(e,n)},V=function(e,t){return e=+e,t-=e,function(n){return Math.round(e+t*n)}},U=180/Math.PI,O={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},F=function(e,t,n,o,r,a){var i,s,l;return(i=Math.sqrt(e*e+t*t))&&(e/=i,t/=i),(l=e*n+t*o)&&(n-=e*l,o-=t*l),(s=Math.sqrt(n*n+o*o))&&(n/=s,o/=s,l/=s),e*o<t*n&&(e=-e,t=-t,l=-l,i=-i),{translateX:r,translateY:a,rotate:Math.atan2(t,e)*U,skewX:Math.atan(l)*U,scaleX:i,scaleY:s}},R=m(d,"px, ","px)","deg)"),B=m(f,", ",")",")"),q=Math.SQRT2,Z=function(e,t){var n,o,r=e[0],a=e[1],i=e[2],s=t[0],l=t[1],u=t[2],c=s-r,d=l-a,f=c*c+d*d;if(f<1e-12)o=Math.log(u/i)/q,n=function(e){return[r+e*c,a+e*d,i*Math.exp(q*e*o)]};else{var m=Math.sqrt(f),v=(u*u-i*i+4*f)/(2*i*2*m),y=(u*u-i*i-4*f)/(2*u*2*m),b=Math.log(Math.sqrt(v*v+1)-v),w=Math.log(Math.sqrt(y*y+1)-y);o=(w-b)/q,n=function(e){var t=e*o,n=p(b),s=i/(2*m)*(n*g(q*t+b)-h(b));return[r+s*c,a+s*d,i*n/p(q*t+b)]}}return n.duration=1e3*o,n},Q=v(a),Y=v(s),G=b(a),J=b(s),X=w(a),W=w(s),K=function(e,t){for(var n=new Array(t),o=0;o<t;++o)n[o]=e(o/(t-1));return n};e.interpolate=z,e.interpolateArray=I,e.interpolateBasis=M,e.interpolateBasisClosed=x,e.interpolateDate=D,e.interpolateNumber=k,e.interpolateObject=T,e.interpolateRound=V,e.interpolateString=j,e.interpolateTransformCss=R,e.interpolateTransformSvg=B,e.interpolateZoom=Z,e.interpolateRgb=A,e.interpolateRgbBasis=L,e.interpolateRgbBasisClosed=$,e.interpolateHsl=Q,e.interpolateHslLong=Y,e.interpolateLab=y,e.interpolateHcl=G,e.interpolateHclLong=J,e.interpolateCubehelix=X,e.interpolateCubehelixLong=W,e.quantize=K,Object.defineProperty(e,"__esModule",{value:!0})}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.d3=e.d3||{})}(this,function(e){"use strict";function t(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===K&&t.documentElement.namespaceURI===K?t.createElement(e):t.createElementNS(n,e)}}function n(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function o(){return new r}function r(){this._="@"+(++oe).toString(36)}function a(e,t,n){return e=i(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function i(t,n,o){return function(r){var a=e.event;e.event=r;try{t.call(this,this.__data__,n,o)}finally{e.event=a}}}function s(e){return e.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}function l(e){return function(){var t=this.__on;if(t){for(var n,o=0,r=-1,a=t.length;o<a;++o)n=t[o],e.type&&n.type!==e.type||n.name!==e.name?t[++r]=n:this.removeEventListener(n.type,n.listener,n.capture);++r?t.length=r:delete this.__on}}}function u(e,t,n){var o=le.hasOwnProperty(e.type)?a:i;return function(r,a,i){var s,l=this.__on,u=o(t,a,i);if(l)for(var c=0,d=l.length;c<d;++c)if((s=l[c]).type===e.type&&s.name===e.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=u,s.capture=n),void(s.value=t);this.addEventListener(e.type,u,n),s={type:e.type,name:e.name,value:t,listener:u,capture:n},l?l.push(s):this.__on=[s]}}function c(t,n,o,r){var a=e.event;t.sourceEvent=e.event,e.event=t;try{return n.apply(o,r)}finally{e.event=a}}function d(){}function f(){return[]}function m(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function p(e,t,n,o,r,a){for(var i,s=0,l=t.length,u=a.length;s<u;++s)(i=t[s])?(i.__data__=a[s],o[s]=i):n[s]=new m(e,a[s]);for(;s<l;++s)(i=t[s])&&(r[s]=i)}function h(e,t,n,o,r,a,i){var s,l,u,c={},d=t.length,f=a.length,p=new Array(d);for(s=0;s<d;++s)(l=t[s])&&(p[s]=u=Se+i.call(l,l.__data__,s,t),u in c?r[s]=l:c[u]=l);for(s=0;s<f;++s)u=Se+i.call(e,a[s],s,a),(l=c[u])?(o[s]=l,l.__data__=a[s],c[u]=null):n[s]=new m(e,a[s]);for(s=0;s<d;++s)(l=t[s])&&c[p[s]]===l&&(r[s]=l)}function g(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function v(e){return function(){this.removeAttribute(e)}}function y(e){return function(){this.removeAttributeNS(e.space,e.local)}}function b(e,t){return function(){this.setAttribute(e,t)}}function w(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function S(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function C(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function P(e){return function(){this.style.removeProperty(e)}}function N(e,t,n){return function(){this.style.setProperty(e,t,n)}}function M(e,t,n){return function(){var o=t.apply(this,arguments);null==o?this.style.removeProperty(e):this.style.setProperty(e,o,n)}}function x(e,t){return e.style.getPropertyValue(t)||Te(e).getComputedStyle(e,null).getPropertyValue(t)}function _(e){return function(){delete this[e]}}function A(e,t){return function(){this[e]=t}}function L(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function $(e){return e.trim().split(/^|\s+/)}function I(e){return e.classList||new D(e)}function D(e){this._node=e,this._names=$(e.getAttribute("class")||"")}function k(e,t){for(var n=I(e),o=-1,r=t.length;++o<r;)n.add(t[o])}function T(e,t){for(var n=I(e),o=-1,r=t.length;++o<r;)n.remove(t[o])}function E(e){return function(){k(this,e)}}function H(e){return function(){T(this,e)}}function j(e,t){return function(){(t.apply(this,arguments)?k:T)(this,e)}}function z(){this.textContent=""}function V(e){return function(){this.textContent=e}}function U(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function O(){this.innerHTML=""}function F(e){return function(){this.innerHTML=e}}function R(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function B(){this.nextSibling&&this.parentNode.appendChild(this)}function q(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Z(){return null}function Q(){var e=this.parentNode;e&&e.removeChild(this)}function Y(e,t,n){var o=Te(e),r=o.CustomEvent;"function"==typeof r?r=new r(t,n):(r=o.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function G(e,t){return function(){return Y(this,e,t)}}function J(e,t){return function(){return Y(this,e,t.apply(this,arguments))}}function X(e,t){this._groups=e,this._parents=t}function W(){return new X([[document.documentElement]],Qe)}var K="http://www.w3.org/1999/xhtml",ee={svg:"http://www.w3.org/2000/svg",xhtml:K,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},te=function(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),ee.hasOwnProperty(t)?{space:ee[t],local:e}:e},ne=function(e){var o=te(e);return(o.local?n:t)(o)},oe=0;r.prototype=o.prototype={constructor:r,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};var re=function(e){return function(){return this.matches(e)}};if("undefined"!=typeof document){var ae=document.documentElement;if(!ae.matches){var ie=ae.webkitMatchesSelector||ae.msMatchesSelector||ae.mozMatchesSelector||ae.oMatchesSelector;re=function(e){return function(){return ie.call(this,e)}}}}var se=re,le={};e.event=null,"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(le={mouseenter:"mouseover",mouseleave:"mouseout"}));var ue=function(e,t,n){var o,r,a=s(e+""),i=a.length;if(!(arguments.length<2)){for(c=t?u:l,null==n&&(n=!1),o=0;o<i;++o)this.each(c(a[o],t,n));return this}var c=this.node().__on;if(c)for(var d,f=0,m=c.length;f<m;++f)for(o=0,d=c[f];o<i;++o)if((r=a[o]).type===d.type&&r.name===d.name)return d.value},ce=function(){for(var t,n=e.event;t=n.sourceEvent;)n=t;return n},de=function(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=t.clientX,o.y=t.clientY,o=o.matrixTransform(e.getScreenCTM().inverse()),[o.x,o.y]}var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]},fe=function(e){var t=ce();return t.changedTouches&&(t=t.changedTouches[0]),de(e,t)},me=function(e){return null==e?d:function(){return this.querySelector(e)}},pe=function(e){"function"!=typeof e&&(e=me(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var a,i,s=t[r],l=s.length,u=o[r]=new Array(l),c=0;c<l;++c)(a=s[c])&&(i=e.call(a,a.__data__,c,s))&&("__data__"in a&&(i.__data__=a.__data__),u[c]=i);return new X(o,this._parents)},he=function(e){return null==e?f:function(){return this.querySelectorAll(e)}},ge=function(e){"function"!=typeof e&&(e=he(e))
;for(var t=this._groups,n=t.length,o=[],r=[],a=0;a<n;++a)for(var i,s=t[a],l=s.length,u=0;u<l;++u)(i=s[u])&&(o.push(e.call(i,i.__data__,u,s)),r.push(i));return new X(o,r)},ve=function(e){"function"!=typeof e&&(e=se(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var a,i=t[r],s=i.length,l=o[r]=[],u=0;u<s;++u)(a=i[u])&&e.call(a,a.__data__,u,i)&&l.push(a);return new X(o,this._parents)},ye=function(e){return new Array(e.length)},be=function(){return new X(this._enter||this._groups.map(ye),this._parents)};m.prototype={constructor:m,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var we=function(e){return function(){return e}},Se="$",Ce=function(e,t){if(!e)return m=new Array(this.size()),u=-1,this.each(function(e){m[++u]=e}),m;var n=t?h:p,o=this._parents,r=this._groups;"function"!=typeof e&&(e=we(e));for(var a=r.length,i=new Array(a),s=new Array(a),l=new Array(a),u=0;u<a;++u){var c=o[u],d=r[u],f=d.length,m=e.call(c,c&&c.__data__,u,o),g=m.length,v=s[u]=new Array(g),y=i[u]=new Array(g);n(c,d,v,y,l[u]=new Array(f),m,t);for(var b,w,S=0,C=0;S<g;++S)if(b=v[S]){for(S>=C&&(C=S+1);!(w=y[C])&&++C<g;);b._next=w||null}}return i=new X(i,o),i._enter=s,i._exit=l,i},Pe=function(){return new X(this._exit||this._groups.map(ye),this._parents)},Ne=function(e){for(var t=this._groups,n=e._groups,o=t.length,r=n.length,a=Math.min(o,r),i=new Array(o),s=0;s<a;++s)for(var l,u=t[s],c=n[s],d=u.length,f=i[s]=new Array(d),m=0;m<d;++m)(l=u[m]||c[m])&&(f[m]=l);for(;s<o;++s)i[s]=t[s];return new X(i,this._parents)},Me=function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var o,r=e[t],a=r.length-1,i=r[a];--a>=0;)(o=r[a])&&(i&&i!==o.nextSibling&&i.parentNode.insertBefore(o,i),i=o);return this},xe=function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=g);for(var n=this._groups,o=n.length,r=new Array(o),a=0;a<o;++a){for(var i,s=n[a],l=s.length,u=r[a]=new Array(l),c=0;c<l;++c)(i=s[c])&&(u[c]=i);u.sort(t)}return new X(r,this._parents).order()},_e=function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},Ae=function(){var e=new Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e},Le=function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,a=o.length;r<a;++r){var i=o[r];if(i)return i}return null},$e=function(){var e=0;return this.each(function(){++e}),e},Ie=function(){return!this.node()},De=function(e){for(var t=this._groups,n=0,o=t.length;n<o;++n)for(var r,a=t[n],i=0,s=a.length;i<s;++i)(r=a[i])&&e.call(r,r.__data__,i,a);return this},ke=function(e,t){var n=te(e);if(arguments.length<2){var o=this.node();return n.local?o.getAttributeNS(n.space,n.local):o.getAttribute(n)}return this.each((null==t?n.local?y:v:"function"==typeof t?n.local?C:S:n.local?w:b)(n,t))},Te=function(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView},Ee=function(e,t,n){return arguments.length>1?this.each((null==t?P:"function"==typeof t?M:N)(e,t,null==n?"":n)):x(this.node(),e)},He=function(e,t){return arguments.length>1?this.each((null==t?_:"function"==typeof t?L:A)(e,t)):this.node()[e]};D.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var je=function(e,t){var n=$(e+"");if(arguments.length<2){for(var o=I(this.node()),r=-1,a=n.length;++r<a;)if(!o.contains(n[r]))return!1;return!0}return this.each(("function"==typeof t?j:t?E:H)(n,t))},ze=function(e){return arguments.length?this.each(null==e?z:("function"==typeof e?U:V)(e)):this.node().textContent},Ve=function(e){return arguments.length?this.each(null==e?O:("function"==typeof e?R:F)(e)):this.node().innerHTML},Ue=function(){return this.each(B)},Oe=function(){return this.each(q)},Fe=function(e){var t="function"==typeof e?e:ne(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},Re=function(e,t){var n="function"==typeof e?e:ne(e),o=null==t?Z:"function"==typeof t?t:me(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),o.apply(this,arguments)||null)})},Be=function(){return this.each(Q)},qe=function(e){return arguments.length?this.property("__data__",e):this.node().__data__},Ze=function(e,t){return this.each(("function"==typeof t?J:G)(e,t))},Qe=[null];X.prototype=W.prototype={constructor:X,select:pe,selectAll:ge,filter:ve,data:Ce,enter:be,exit:Pe,merge:Ne,order:Me,sort:xe,call:_e,nodes:Ae,node:Le,size:$e,empty:Ie,each:De,attr:ke,style:Ee,property:He,classed:je,text:ze,html:Ve,raise:Ue,lower:Oe,append:Fe,insert:Re,remove:Be,datum:qe,on:ue,dispatch:Ze};var Ye=function(e){return"string"==typeof e?new X([[document.querySelector(e)]],[document.documentElement]):new X([[e]],Qe)},Ge=function(e){return"string"==typeof e?new X([document.querySelectorAll(e)],[document.documentElement]):new X([null==e?[]:e],Qe)},Je=function(e,t,n){arguments.length<3&&(n=t,t=ce().changedTouches);for(var o,r=0,a=t?t.length:0;r<a;++r)if((o=t[r]).identifier===n)return de(e,o);return null},Xe=function(e,t){null==t&&(t=ce().touches);for(var n=0,o=t?t.length:0,r=new Array(o);n<o;++n)r[n]=de(e,t[n]);return r};e.creator=ne,e.local=o,e.matcher=se,e.mouse=fe,e.namespace=te,e.namespaces=ee,e.select=Ye,e.selectAll=Ge,e.selection=W,e.selector=me,e.selectorAll=he,e.style=x,e.touch=Je,e.touches=Xe,e.window=Te,e.customEvent=c,Object.defineProperty(e,"__esModule",{value:!0})}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.d3=e.d3||{})}(this,function(e){"use strict";function t(){return v||(w(n),v=b.now()+y)}function n(){v=0}function o(){this._call=this._time=this._next=null}function r(e,t,n){var r=new o;return r.restart(e,t,n),r}function a(){t(),++f;for(var e,n=c;n;)(e=v-n._time)>=0&&n._call.call(null,e),n=n._next;--f}function i(){v=(g=b.now())+y,f=m=0;try{a()}finally{f=0,l(),v=0}}function s(){var e=b.now(),t=e-g;t>h&&(y-=t,g=e)}function l(){for(var e,t,n=c,o=1/0;n;)n._call?(o>n._time&&(o=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:c=t);d=e,u(o)}function u(e){if(!f){m&&(m=clearTimeout(m));var t=e-v;t>24?(e<1/0&&(m=setTimeout(i,t)),p&&(p=clearInterval(p))):(p||(g=v,p=setInterval(s,h)),f=1,w(i))}}var c,d,f=0,m=0,p=0,h=1e3,g=0,v=0,y=0,b="object"==typeof performance&&performance.now?performance:Date,w="function"==typeof requestAnimationFrame?requestAnimationFrame:function(e){setTimeout(e,17)};o.prototype=r.prototype={constructor:o,restart:function(e,n,o){if("function"!=typeof e)throw new TypeError("callback is not a function");o=(null==o?t():+o)+(null==n?0:+n),this._next||d===this||(d?d._next=this:c=this,d=this),this._call=e,this._time=o,u()},stop:function(){this._call&&(this._call=null,this._time=1/0,u())}};var S=function(e,t,n){var r=new o;return t=null==t?0:+t,r.restart(function(n){r.stop(),e(n+t)},t,n),r},C=function(e,n,r){var a=new o,i=n;return null==n?(a.restart(e,n,r),a):(n=+n,r=null==r?t():+r,a.restart(function t(o){o+=i,a.restart(t,i+=n,r),e(o)},n,r),a)};e.now=t,e.timer=r,e.timerFlush=a,e.timeout=S,e.interval=C,Object.defineProperty(e,"__esModule",{value:!0})}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3-selection"),require("d3-dispatch"),require("d3-timer"),require("d3-interpolate"),require("d3-color"),require("d3-ease")):"function"==typeof define&&define.amd?define(["exports","d3-selection","d3-dispatch","d3-timer","d3-interpolate","d3-color","d3-ease"],t):t(e.d3=e.d3||{},e.d3,e.d3,e.d3,e.d3,e.d3,e.d3)}(this,function(e,t,n,o,r,a,i){"use strict";function s(e,t){var n=e.__transition;if(!n||!(n=n[t])||n.state>R)throw new Error("too late");return n}function l(e,t){var n=e.__transition;if(!n||!(n=n[t])||n.state>q)throw new Error("too late");return n}function u(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("too late");return n}function c(e,t,n){function r(e){n.state=B,n.timer.restart(a,n.delay,n.time),n.delay<=e&&a(e-n.delay)}function a(r){var c,d,f,m;if(n.state!==B)return s();for(c in u)if(m=u[c],m.name===n.name){if(m.state===Z)return o.timeout(a);m.state===Q?(m.state=G,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete u[c]):+c<t&&(m.state=G,m.timer.stop(),delete u[c])}if(o.timeout(function(){n.state===Z&&(n.state=Q,n.timer.restart(i,n.delay,n.time),i(r))}),n.state=q,n.on.call("start",e,e.__data__,n.index,n.group),n.state===q){for(n.state=Z,l=new Array(f=n.tween.length),c=0,d=-1;c<f;++c)(m=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(l[++d]=m);l.length=d+1}}function i(t){for(var o=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(s),n.state=Y,1),r=-1,a=l.length;++r<a;)l[r].call(null,o);n.state===Y&&(n.on.call("end",e,e.__data__,n.index,n.group),s())}function s(){n.state=G,n.timer.stop(),delete u[t];for(var o in u)return;delete e.__transition}var l,u=e.__transition;u[t]=n,n.timer=o.timer(r,0,n.time)}function d(e,t){var n,o;return function(){var r=l(this,e),a=r.tween;if(a!==n){o=n=a;for(var i=0,s=o.length;i<s;++i)if(o[i].name===t){o=o.slice(),o.splice(i,1);break}}r.tween=o}}function f(e,t,n){var o,r;if("function"!=typeof n)throw new Error;return function(){var a=l(this,e),i=a.tween;if(i!==o){r=(o=i).slice();for(var s={name:t,value:n},u=0,c=r.length;u<c;++u)if(r[u].name===t){r[u]=s;break}u===c&&r.push(s)}a.tween=r}}function m(e,t,n){var o=e._id;return e.each(function(){var e=l(this,o);(e.value||(e.value={}))[t]=n.apply(this,arguments)}),function(e){return u(e,o).value[t]}}function p(e){return function(){this.removeAttribute(e)}}function h(e){return function(){this.removeAttributeNS(e.space,e.local)}}function g(e,t,n){var o,r;return function(){var a=this.getAttribute(e);return a===n?null:a===o?r:r=t(o=a,n)}}function v(e,t,n){var o,r;return function(){var a=this.getAttributeNS(e.space,e.local);return a===n?null:a===o?r:r=t(o=a,n)}}function y(e,t,n){var o,r,a;return function(){var i,s=n(this);return null==s?void this.removeAttribute(e):(i=this.getAttribute(e),i===s?null:i===o&&s===r?a:a=t(o=i,r=s))}}function b(e,t,n){var o,r,a;return function(){var i,s=n(this);return null==s?void this.removeAttributeNS(e.space,e.local):(i=this.getAttributeNS(e.space,e.local),i===s?null:i===o&&s===r?a:a=t(o=i,r=s))}}function w(e,t){function n(){var n=this,o=t.apply(n,arguments);return o&&function(t){n.setAttributeNS(e.space,e.local,o(t))}}return n._value=t,n}function S(e,t){function n(){var n=this,o=t.apply(n,arguments);return o&&function(t){n.setAttribute(e,o(t))}}return n._value=t,n}function C(e,t){return function(){s(this,e).delay=+t.apply(this,arguments)}}function P(e,t){return t=+t,function(){s(this,e).delay=t}}function N(e,t){return function(){l(this,e).duration=+t.apply(this,arguments)}}function M(e,t){return t=+t,function(){l(this,e).duration=t}}function x(e,t){if("function"!=typeof t)throw new Error;return function(){l(this,e).ease=t}}function _(e){return(e+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})}function A(e,t,n){var o,r,a=_(t)?s:l;return function(){var i=a(this,e),s=i.on;s!==o&&(r=(o=s).copy()).on(t,n),i.on=r}}function L(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function $(e,n){var o,r,a;return function(){var i=t.style(this,e),s=(this.style.removeProperty(e),t.style(this,e));return i===s?null:i===o&&s===r?a:a=n(o=i,r=s)}}function I(e){return function(){this.style.removeProperty(e)}}function D(e,n,o){var r,a;return function(){var i=t.style(this,e);return i===o?null:i===r?a:a=n(r=i,o)}}function k(e,n,o){var r,a,i;return function(){var s=t.style(this,e),l=o(this);return null==l&&(this.style.removeProperty(e),l=t.style(this,e)),s===l?null:s===r&&l===a?i:i=n(r=s,a=l)}}function T(e,t,n){function o(){var o=this,r=t.apply(o,arguments);return r&&function(t){o.style.setProperty(e,r(t),n)}}return o._value=t,o}function E(e){return function(){this.textContent=e}}function H(e){return function(){var t=e(this);this.textContent=null==t?"":t}}function j(e,t,n,o){this._groups=e,this._parents=t,this._name=n,this._id=o}function z(e){return t.selection().transition(e)}function V(){return++ye}function U(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))return we.time=o.now(),we;return n}var O=n.dispatch("start","end","interrupt"),F=[],R=0,B=1,q=2,Z=3,Q=4,Y=5,G=6,J=function(e,t,n,o,r,a){var i=e.__transition;if(i){if(n in i)return}else e.__transition={};c(e,n,{name:t,index:o,group:r,on:O,tween:F,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:R})},X=function(e,t){var n,o,r,a=e.__transition,i=!0;if(a){t=null==t?null:t+"";for(r in a)(n=a[r]).name===t?(o=n.state>q&&n.state<Y,n.state=G,n.timer.stop(),o&&n.on.call("interrupt",e,e.__data__,n.index,n.group),delete a[r]):i=!1;i&&delete e.__transition}},W=function(e){return this.each(function(){X(this,e)})},K=function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var o,r=u(this.node(),n).tween,a=0,i=r.length;a<i;++a)if((o=r[a]).name===e)return o.value;return null}return this.each((null==t?d:f)(n,e,t))},ee=function(e,t){var n;return("number"==typeof t?r.interpolateNumber:t instanceof a.color?r.interpolateRgb:(n=a.color(t))?(t=n,r.interpolateRgb):r.interpolateString)(e,t)},te=function(e,n){var o=t.namespace(e),a="transform"===o?r.interpolateTransformSvg:ee;return this.attrTween(e,"function"==typeof n?(o.local?b:y)(o,a,m(this,"attr."+e,n)):null==n?(o.local?h:p)(o):(o.local?v:g)(o,a,n+""))},ne=function(e,n){var o="attr."+e;if(arguments.length<2)return(o=this.tween(o))&&o._value;if(null==n)return this.tween(o,null);if("function"!=typeof n)throw new Error;var r=t.namespace(e);return this.tween(o,(r.local?w:S)(r,n))},oe=function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?C:P)(t,e)):u(this.node(),t).delay},re=function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?N:M)(t,e)):u(this.node(),t).duration},ae=function(e){var t=this._id;return arguments.length?this.each(x(t,e)):u(this.node(),t).ease},ie=function(e){"function"!=typeof e&&(e=t.matcher(e));for(var n=this._groups,o=n.length,r=new Array(o),a=0;a<o;++a)for(var i,s=n[a],l=s.length,u=r[a]=[],c=0;c<l;++c)(i=s[c])&&e.call(i,i.__data__,c,s)&&u.push(i);return new j(r,this._parents,this._name,this._id)},se=function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,o=t.length,r=n.length,a=Math.min(o,r),i=new Array(o),s=0;s<a;++s)for(var l,u=t[s],c=n[s],d=u.length,f=i[s]=new Array(d),m=0;m<d;++m)(l=u[m]||c[m])&&(f[m]=l);for(;s<o;++s)i[s]=t[s];return new j(i,this._parents,this._name,this._id)},le=function(e,t){var n=this._id;return arguments.length<2?u(this.node(),n).on.on(e):this.each(A(n,e,t))},ue=function(){return this.on("end.remove",L(this._id))},ce=function(e){var n=this._name,o=this._id;"function"!=typeof e&&(e=t.selector(e));for(var r=this._groups,a=r.length,i=new Array(a),s=0;s<a;++s)for(var l,c,d=r[s],f=d.length,m=i[s]=new Array(f),p=0;p<f;++p)(l=d[p])&&(c=e.call(l,l.__data__,p,d))&&("__data__"in l&&(c.__data__=l.__data__),m[p]=c,J(m[p],n,o,p,m,u(l,o)));return new j(i,this._parents,n,o)},de=function(e){var n=this._name,o=this._id;"function"!=typeof e&&(e=t.selectorAll(e));for(var r=this._groups,a=r.length,i=[],s=[],l=0;l<a;++l)for(var c,d=r[l],f=d.length,m=0;m<f;++m)if(c=d[m]){for(var p,h=e.call(c,c.__data__,m,d),g=u(c,o),v=0,y=h.length;v<y;++v)(p=h[v])&&J(p,n,o,v,h,g);i.push(h),s.push(c)}return new j(i,s,n,o)},fe=t.selection.prototype.constructor,me=function(){return new fe(this._groups,this._parents)},pe=function(e,t,n){var o="transform"==(e+="")?r.interpolateTransformCss:ee;return null==t?this.styleTween(e,$(e,o)).on("end.style."+e,I(e)):this.styleTween(e,"function"==typeof t?k(e,o,m(this,"style."+e,t)):D(e,o,t+""),n)},he=function(e,t,n){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(null==t)return this.tween(o,null);if("function"!=typeof t)throw new Error;return this.tween(o,T(e,t,null==n?"":n))},ge=function(e){return this.tween("text","function"==typeof e?H(m(this,"text",e)):E(null==e?"":e+""))},ve=function(){for(var e=this._name,t=this._id,n=V(),o=this._groups,r=o.length,a=0;a<r;++a)for(var i,s=o[a],l=s.length,c=0;c<l;++c)if(i=s[c]){var d=u(i,t);J(i,e,n,c,s,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new j(o,this._parents,e,n)},ye=0,be=t.selection.prototype;j.prototype=z.prototype={constructor:j,select:ce,selectAll:de,filter:ie,merge:se,selection:me,transition:ve,call:be.call,nodes:be.nodes,node:be.node,size:be.size,empty:be.empty,each:be.each,on:le,attr:te,attrTween:ne,style:pe,styleTween:he,text:ge,remove:ue,tween:K,delay:oe,duration:re,ease:ae};var we={time:null,delay:0,duration:250,ease:i.easeCubicInOut},Se=function(e){var t,n;e instanceof j?(t=e._id,e=e._name):(t=V(),(n=we).time=o.now(),e=null==e?null:e+"");for(var r=this._groups,a=r.length,i=0;i<a;++i)for(var s,l=r[i],u=l.length,c=0;c<u;++c)(s=l[c])&&J(s,e,t,c,l,n||U(s,t));return new j(r,this._parents,e,t)};t.selection.prototype.interrupt=W,t.selection.prototype.transition=Se;var Ce=[null],Pe=function(e,t){var n,o,r=e.__transition;if(r){t=null==t?null:t+"";for(o in r)if((n=r[o]).state>B&&n.name===t)return new j([[e]],Ce,t,+o)}return null};e.transition=z,e.active=Pe,e.interrupt=X,Object.defineProperty(e,"__esModule",{value:!0})}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3-dispatch"),require("d3-drag"),require("d3-interpolate"),require("d3-selection"),require("d3-transition")):"function"==typeof define&&define.amd?define(["exports","d3-dispatch","d3-drag","d3-interpolate","d3-selection","d3-transition"],t):t(e.d3=e.d3||{},e.d3,e.d3,e.d3,e.d3,e.d3)}(this,function(e,t,n,o,r,a){"use strict";function i(e,t,n){this.target=e,this.type=t,this.transform=n}function s(e,t,n){this.k=e,this.x=t,this.y=n}function l(e){return e.__zoom||p}function u(){r.event.stopImmediatePropagation()}function c(){return!r.event.button}function d(){var e,t,n=this;return n instanceof SVGElement?(n=n.ownerSVGElement||n,e=n.width.baseVal.value,t=n.height.baseVal.value):(e=n.clientWidth,t=n.clientHeight),[[0,0],[e,t]]}function f(){return this.__zoom||p}var m=function(e){return function(){return e}};s.prototype={constructor:s,scale:function(e){return 1===e?this:new s(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new s(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var p=new s(1,0,0);l.prototype=s.prototype;var h=function(){r.event.preventDefault(),r.event.stopImmediatePropagation()},g=function(){function e(e){e.on("wheel.zoom",S).on("mousedown.zoom",C).on("dblclick.zoom",P).on("touchstart.zoom",N).on("touchmove.zoom",M).on("touchend.zoom touchcancel.zoom",x).style("-webkit-tap-highlight-color","rgba(0,0,0,0)").property("__zoom",f)}function l(e,t){return t=Math.max(I,Math.min(D,t)),t===e.k?e:new s(t,e.x,e.y)}function p(e,t,n){var o=t[0]-n[0]*e.k,r=t[1]-n[1]*e.k;return o===e.x&&r===e.y?e:new s(e.k,o,r)}function g(e,t){var n=e.invertX(t[0][0])-k,o=e.invertX(t[1][0])-T,r=e.invertY(t[0][1])-E,a=e.invertY(t[1][1])-H;return e.translate(o>n?(n+o)/2:Math.min(0,n)||Math.max(0,o),a>r?(r+a)/2:Math.min(0,r)||Math.max(0,a))}function v(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function y(e,t,n){e.on("start.zoom",function(){b(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){b(this,arguments).end()}).tween("zoom",function(){var e=this,o=arguments,r=b(e,o),a=$.apply(e,o),i=n||v(a),l=Math.max(a[1][0]-a[0][0],a[1][1]-a[0][1]),u=e.__zoom,c="function"==typeof t?t.apply(e,o):t,d=z(u.invert(i).concat(l/u.k),c.invert(i).concat(l/c.k));return function(e){if(1===e)e=c;else{var t=d(e),n=l/t[2];e=new s(n,i[0]-t[0]*n,i[1]-t[1]*n)}r.zoom(null,e)}})}function b(e,t){for(var n,o=0,r=V.length;o<r;++o)if((n=V[o]).that===e)return n;return new w(e,t)}function w(e,t){this.that=e,this.args=t,this.index=-1,this.active=0,this.extent=$.apply(e,t)}function S(){function e(){t.wheel=null,t.end()}if(L.apply(this,arguments)){var t=b(this,arguments),n=this.__zoom,o=Math.max(I,Math.min(D,n.k*Math.pow(2,-r.event.deltaY*(r.event.deltaMode?120:1)/500))),i=r.mouse(this);if(t.wheel)t.mouse[0][0]===i[0]&&t.mouse[0][1]===i[1]||(t.mouse[1]=n.invert(t.mouse[0]=i)),clearTimeout(t.wheel);else{if(n.k===o)return;t.mouse=[i,n.invert(i)],a.interrupt(this),t.start()}h(),t.wheel=setTimeout(e,F),t.zoom("mouse",g(p(l(n,o),t.mouse[0],t.mouse[1]),t.extent))}}function C(){function e(){if(h(),!o.moved){var e=r.event.clientX-l,t=r.event.clientY-c;o.moved=e*e+t*t>R}o.zoom("mouse",g(p(o.that.__zoom,o.mouse[0]=r.mouse(o.that),o.mouse[1]),o.extent))}function t(){i.on("mousemove.zoom mouseup.zoom",null),n.dragEnable(r.event.view,o.moved),h(),o.end()}if(!A&&L.apply(this,arguments)){var o=b(this,arguments),i=r.select(r.event.view).on("mousemove.zoom",e,!0).on("mouseup.zoom",t,!0),s=r.mouse(this),l=r.event.clientX,c=r.event.clientY;n.dragDisable(r.event.view),u(),o.mouse=[s,this.__zoom.invert(s)],a.interrupt(this),o.start()}}function P(){if(L.apply(this,arguments)){var t=this.__zoom,n=r.mouse(this),o=t.invert(n),a=t.k*(r.event.shiftKey?.5:2),i=g(p(l(t,a),n,o),$.apply(this,arguments));h(),j>0?r.select(this).transition().duration(j).call(y,i,n):r.select(this).call(e.transform,i)}}function N(){if(L.apply(this,arguments)){var e,t,n,o,i=b(this,arguments),s=r.event.changedTouches,l=s.length;for(u(),t=0;t<l;++t)n=s[t],o=r.touch(this,s,n.identifier),o=[o,this.__zoom.invert(o),n.identifier],i.touch0?i.touch1||(i.touch1=o):(i.touch0=o,e=!0);if(_&&(_=clearTimeout(_),!i.touch1))return i.end(),void((o=r.select(this).on("dblclick.zoom"))&&o.apply(this,arguments));e&&(_=setTimeout(function(){_=null},O),a.interrupt(this),i.start())}}function M(){var e,t,n,o,a=b(this,arguments),i=r.event.changedTouches,s=i.length;for(h(),_&&(_=clearTimeout(_)),e=0;e<s;++e)t=i[e],n=r.touch(this,i,t.identifier),a.touch0&&a.touch0[2]===t.identifier?a.touch0[0]=n:a.touch1&&a.touch1[2]===t.identifier&&(a.touch1[0]=n);if(t=a.that.__zoom,a.touch1){var u=a.touch0[0],c=a.touch0[1],d=a.touch1[0],f=a.touch1[1],m=(m=d[0]-u[0])*m+(m=d[1]-u[1])*m,v=(v=f[0]-c[0])*v+(v=f[1]-c[1])*v;t=l(t,Math.sqrt(m/v)),n=[(u[0]+d[0])/2,(u[1]+d[1])/2],o=[(c[0]+f[0])/2,(c[1]+f[1])/2]}else{if(!a.touch0)return;n=a.touch0[0],o=a.touch0[1]}a.zoom("touch",g(p(t,n,o),a.extent))}function x(){var e,t,n=b(this,arguments),o=r.event.changedTouches,a=o.length;for(u(),A&&clearTimeout(A),A=setTimeout(function(){A=null},O),e=0;e<a;++e)t=o[e],n.touch0&&n.touch0[2]===t.identifier?delete n.touch0:n.touch1&&n.touch1[2]===t.identifier&&delete n.touch1;n.touch1&&!n.touch0&&(n.touch0=n.touch1,delete n.touch1),n.touch0?n.touch0[1]=this.__zoom.invert(n.touch0[0]):n.end()}var _,A,L=c,$=d,I=0,D=1/0,k=-D,T=D,E=k,H=T,j=250,z=o.interpolateZoom,V=[],U=t.dispatch("start","zoom","end"),O=500,F=150,R=0;return e.transform=function(e,t){var n=e.selection?e.selection():e;n.property("__zoom",f),e!==n?y(e,t):n.interrupt().each(function(){b(this,arguments).start().zoom(null,"function"==typeof t?t.apply(this,arguments):t).end()})},e.scaleBy=function(t,n){e.scaleTo(t,function(){return this.__zoom.k*("function"==typeof n?n.apply(this,arguments):n)})},e.scaleTo=function(t,n){e.transform(t,function(){var e=$.apply(this,arguments),t=this.__zoom,o=v(e),r=t.invert(o);return g(p(l(t,"function"==typeof n?n.apply(this,arguments):n),o,r),e)})},e.translateBy=function(t,n,o){e.transform(t,function(){return g(this.__zoom.translate("function"==typeof n?n.apply(this,arguments):n,"function"==typeof o?o.apply(this,arguments):o),$.apply(this,arguments))})},w.prototype={start:function(){return 1==++this.active&&(this.index=V.push(this)-1,this.emit("start")),this},zoom:function(e,t){return this.mouse&&"mouse"!==e&&(this.mouse[1]=t.invert(this.mouse[0])),this.touch0&&"touch"!==e&&(this.touch0[1]=t.invert(this.touch0[0])),this.touch1&&"touch"!==e&&(this.touch1[1]=t.invert(this.touch1[0])),this.that.__zoom=t,this.emit("zoom"),this},end:function(){return 0==--this.active&&(V.splice(this.index,1),this.index=-1,this.emit("end")),this},emit:function(t){r.customEvent(new i(e,t,this.that.__zoom),U.apply,U,[t,this.that,this.args])}},e.filter=function(t){return arguments.length?(L="function"==typeof t?t:m(!!t),e):L},e.extent=function(t){return arguments.length?($="function"==typeof t?t:m([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),e):$},e.scaleExtent=function(t){return arguments.length?(I=+t[0],D=+t[1],e):[I,D]},e.translateExtent=function(t){return arguments.length?(k=+t[0][0],T=+t[1][0],E=+t[0][1],H=+t[1][1],e):[[k,E],[T,H]]},e.duration=function(t){return arguments.length?(j=+t,e):j},e.interpolate=function(t){return arguments.length?(z=t,e):z},e.on=function(){var t=U.on.apply(U,arguments);return t===U?e:t},e.clickDistance=function(t){return arguments.length?(R=(t=+t)*t,e):Math.sqrt(R)},e};e.zoom=g,e.zoomTransform=l,e.zoomIdentity=p,Object.defineProperty(e,"__esModule",{value:!0})});var global;try{global=Function("return this")()||(0,eval)("this")}catch(e){global=window}global.global=global,function(e){function t(e){function t(e,t){return d[e]={validators:[].concat(t),error:null},this}function n(e,t){return 1===arguments.length?(d[e]||{}).error||null:2===arguments.length?(d[e]||{}).error=t||null:void 0}function o(){u(arguments).forEach(function(e){d[e].error=null})}function r(){var e=!0;return u(arguments).forEach(function(t){c(t,d[t].validators)&&(e=!1)}),e}function a(){var e=!0;return u(arguments).forEach(function(t){var n=d[t];n.error=n.error&&c(t,n.validators),n.error&&(e=!1)}),e}function i(){var e=!0;return u(arguments).forEach(function(t){var n=d[t];n.error=c(t,n.validators),n.error&&(e=!1)}),e}function s(){var e=!0;return u(arguments).forEach(function(t){d[t].error&&(e=!1)}),e}function l(e){Object.keys(d).forEach(function(t){d[t].error=e[t]||null})}function u(e){var t=Object.keys(d);return e.length?Array.from(e).filter(function(e){return t.indexOf(e)>=0}):t}function c(t,n){if(!n)return null;for(var o=e[t],r=0;r<n.length;r++){var a=n[r](o);if(!0===a)break;if(a)return a}return null}var d={};this.field=t,this.error=n,this.clear=o,this.see=r,this.check=a,this.validate=i,this.status=s,this.dictate=l}function n(e){return e=e||"     ",function(t){return t?null:e}}function o(){return function(e){return!e}}function r(e){return e=e||"    ",function(t){return/^[0-9]{10}$/.test(t)?null:e}}function a(e,t){return t=t||"     ",function(n){return String(n).length===e&&/^[0-9]+$/.test(n)?null:t}}function i(e){return e=e||"      ",function(t){return/^(\+98)?[0-9]{5,15}$/.test(t)?null:e}}function s(e){return e=e||"      ",function(t){return/^(\+989|09)[0-9]{9}$/.test(t)?null:e}}function l(e,t){return t=t||"    "+toPersianNumber(e)+"   ",function(n){return String(n).length>=e?null:t}}function u(e,t){return t=t||"    "+toPersianNumber(e)+"   ",function(n){return String(n).length===e?null:t}}function c(e){return e=e||"            _ ",function(t){return/^[a-zA-Z_][a-zA-Z_0-9]+$/.test(t)?null:e}}function d(e){return e=e||"        ",function(t){return/^[0-9]*$/.test(t)?null:e}}function f(e){return e=e||"     ",function(t){return/^((http|https):\/\/)?[a-zA-Z0-9-_\.]+\.[a-zA-Z0-9]+$/.test(t)?null:e}}function m(e){return e=e||"    ",function(t){return/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(t)?null:e}}e.ValidationSystem=t,t.validators={notEmpty:n,notRequired:o,nationalCode:r,numberCode:a,phoneNumber:i,mobilePhoneNumber:s,minLength:l,length:u,username:c,integer:d,url:f,email:m}}(global),function(){function e(e){var t=e[0],n=e[1],o=e[2],r=[0,31,59,90,120,151,181,212,243,273,304,334],a=t<=1600?0:979;t-=t<=1600?621:1600;var i=n>2?t+1:t,s=365*t+parseInt((i+3)/4,10)-parseInt((i+99)/100,10)+parseInt((i+399)/400,10)-80+o+r[n-1];return a+=33*parseInt(s/12053,10),s%=12053,a+=4*parseInt(s/1461,10),s%=1461,a+=parseInt((s-1)/365,10),s>365&&(s=(s-1)%365),[a,s<186?1+parseInt(s/31,10):7+parseInt((s-186)/30,10),1+(s<186?s%31:(s-186)%30)]}function t(e){var t=e[0],n=e[1],o=e[2],r=t<=979?621:1600;t-=t<=979?0:979;var a=365*t+8*parseInt(t/33,10)+parseInt((t%33+3)/4,10)+78+o+(n<7?31*(n-1):30*(n-7)+186);r+=400*parseInt(a/146097,10),a%=146097,a>36524&&(r+=100*parseInt(--a/36524,10),(a%=36524)>=365&&a++),r+=4*parseInt(a/1461,10),a%=1461,r+=parseInt((a-1)/365,10),a>365&&(a=(a-1)%365);for(var i=a+1,s=[0,31,r%4==0&&r%100!=0||r%400==0?29:28,31,30,31,30,31,31,30,31,30,31],l=0;l<13;l++){var u=s[l];if(i<=u)break;i-=u}return[r,l,i]}global.gregorianToJalali=e,global.jalaliToGregorian=t}(),function(e){function t(){function e(e,t){var n=r.match(e);return null!=n&&(n[1]||t||"")}var t=window&&window.document,n=window&&window.navigator,o=(n&&n.appVersion||"").toLowerCase(),r=(n&&n.userAgent||"").toLowerCase(),a=(n&&n.vendor||"").toLowerCase(),i={};return i.touch=!!t&&("ontouchstart"in window||"DocumentTouch"in window&&t instanceof window.DocumentTouch),i.firefox=e(/(?:firefox|fxios)\/(\d+)/),i.ie=e(/(?:msie |trident.+?; rv:)(\d+)/),i.edge=e(/edge\/(\d+)/),i.opera=e(/(?:^opera.+?version|opr)\/(\d+)/),i.safari=e(/version\/(\d+).+?safari/),i.plantom=e(/phantomjs\/(\d+)/),i.chrome=!i.opera&&/google inc/.test(a)&&e(/(?:chrome|crios)\/(\d+)/),i.iPad=e(/ipad.+?os (\d+)/),i.iPhone=!i.iPad&&e(/iphone(?:.+?os (\d+))?/,1),i.iPod=e(/ipod.+?os (\d+)/),i.iOS=!!(i.iPad||i.iPhone||i.iPod),i.android=/android/.test(r),i.androidPhone=i.android&&/mobile/.test(r),i.androidTablet=i.android&&!/mobile/.test(r),i.windows=/win/.test(o),i.windowsPhone=i.windows&&/phone/.test(r),i.windowsTablet=i.windows&&!i.windowsPhone&&/touch/.test(r),i.mac=/mac/.test(o),i.linux=/linux/.test(o),i.blackberry=/blackberry/.test(r)||/bb10/.test(r),i.mobile=!!(i.iPhone||i.iPod||i.androidPhone||i.windowsPhone||i.blackberry),i.tablet=!!(i.iPad||i.androidTablet||i.windowsTablet),i.desktop=!i.mobile&&!i.tablet,i.standalone="standalone"in window.navigator?window.navigator.standalone:!!window.matchMedia("(display-mode)").matches&&window.matchMedia("(display-mode: standalone)").matches,i}e.getEnvironmentProperties=t}(global),function(){function e(){return[this.getFullYear(),this.getMonth()+1,this.getDate()]}function t(){return gregorianToJalali(this.gYMD())}function n(){return this.getTime()===this.getTime()}function o(e){var t=new Date(this);t.setMinutes(t.getMinutes()-t.getTimezoneOffset());var n=t.toISOString().slice(0,-1);if(!e){var o=this.toString(),r=o.indexOf("GMT")+3;n+="O"+o.slice(r,r+5)}return n}function r(){return new Date(Date.parse(this))}function a(){var e=this.replace(/\s/g,"");return"+98"===e.slice(0,3)?e="0"+e.slice(3):"98"===e.slice(0,2)&&(e="0"+e.slice(2)),e.split("").filter(function(e){return"0123456789".indexOf(e)>=0}).join("")}function i(){var e=this.toPhoneNumber()
;return 11===e.length&&"09"===e.slice(0,2)}function s(e,t,n){if(n=n||1,"number"!=typeof e||"number"!=typeof t||"number"!=typeof n)throw new Error("Provided from & to & step are not all numbers.");n<0&&(n=-n);var o=[];if(e<=t)for(;e<=t;)o.push(e++);else for(;e>=t;)o.push(e--);return o}function l(e){return e?Array.prototype.slice.call(e):[]}Date.prototype.gYMD=e,Date.prototype.jYMD=t,Date.prototype.isValid=n,Date.prototype.toLocalString=o,Date.parse=function(){var e=Date.parse;return function(t){if("string"==typeof(t=(t||"").toString())&&"O"===t.slice(-6,-5)){var n=t.slice(-5),o=60*Number(n.slice(1,3))+Number(n.slice(3,5));return"-"===n.slice(0,1)&&(o=-o),e(t.slice(0,-6)+"Z")-60*o*1e3}return e(t)}}(),String.prototype.toDate=r,String.prototype.toPhoneNumber=a,String.prototype.isMobileNumber=i,Array.range=s,Array.from=l}(),function(e){function t(e){return r[e]||a}function n(e){e=e||{},Object.keys(e).forEach(function(t){r[t]=e[t]})}function o(e){function n(t){for(var n=0;n<t.length;n++)if(e.slice(-1-t[n].length)==="."+t[n])return!0;return!1}var o="free file";return n(["doc","docx"])&&(o="doc file"),n(["xls","xlsx"])&&(o="xls file"),n(["pdf"])&&(o="pdf file"),t(o)}t.feed=n,t.file=o,e.iconJs=t;var r={"left arrow":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjEuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJDYXBhXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgMzEuNDk0IDMxLjQ5NCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzEuNDk0IDMxLjQ5NDsiIHhtbDpzcGFjZT0icHJlc2VydmUiPg0KPHBhdGggc3R5bGU9ImZpbGw6IzFFMjAxRDsiIGQ9Ik0xMC4yNzMsNS4wMDljMC40NDQtMC40NDQsMS4xNDMtMC40NDQsMS41ODcsMGMwLjQyOSwwLjQyOSwwLjQyOSwxLjE0MywwLDEuNTcxbC04LjA0Nyw4LjA0N2gyNi41NTQNCgljMC42MTksMCwxLjEyNywwLjQ5MiwxLjEyNywxLjExMWMwLDAuNjE5LTAuNTA4LDEuMTI3LTEuMTI3LDEuMTI3SDMuODEzbDguMDQ3LDguMDMyYzAuNDI5LDAuNDQ0LDAuNDI5LDEuMTU5LDAsMS41ODcNCgljLTAuNDQ0LDAuNDQ0LTEuMTQzLDAuNDQ0LTEuNTg3LDBsLTkuOTUyLTkuOTUyYy0wLjQyOS0wLjQyOS0wLjQyOS0xLjE0MywwLTEuNTcxTDEwLjI3Myw1LjAwOXoiLz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjwvc3ZnPg0K","menu bars":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0ndXRmLTgnPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgJy0vL1czQy8vRFREIFNWRyAxLjEvL0VOJyAnaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkJz4KPHN2ZyB3aWR0aD0iNjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBoZWlnaHQ9IjY0IiB2aWV3Qm94PSIwIDAgNjQgNjQiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA2NCA2NCI+CiAgPGc+CiAgICA8ZyBmaWxsPSIjMUQxRDFCIj4KICAgICAgPHBhdGggZD0iTTIuMjUyLDEwLjI3MWg1OC44NzFjMS4xMjQsMCwyLjAzNC0wLjkxLDIuMDM0LTIuMDM0YzAtMS4xMjMtMC45MS0yLjAzNC0yLjAzNC0yLjAzNEgyLjI1MiAgICBjLTEuMTI0LDAtMi4wMzQsMC45MTEtMi4wMzQsMi4wMzRDMC4yMTgsOS4zNiwxLjEyOCwxMC4yNzEsMi4yNTIsMTAuMjcxeiIvPgogICAgICA8cGF0aCBkPSJtNjEuMTIzLDMwLjAxNWgtNTguODcxYy0xLjEyNCwwLTIuMDM0LDAuOTEyLTIuMDM0LDIuMDM1IDAsMS4xMjIgMC45MSwyLjAzNCAyLjAzNCwyLjAzNGg1OC44NzFjMS4xMjQsMCAyLjAzNC0wLjkxMiAyLjAzNC0yLjAzNC03LjEwNTQzZS0xNS0xLjEyMy0wLjkxLTIuMDM1LTIuMDM0LTIuMDM1eiIvPgogICAgICA8cGF0aCBkPSJtNjEuMTIzLDUzLjg3NmgtNTguODcxYy0xLjEyNCwwLTIuMDM0LDAuOTEtMi4wMzQsMi4wMzQgMCwxLjEyMyAwLjkxLDIuMDM0IDIuMDM0LDIuMDM0aDU4Ljg3MWMxLjEyNCwwIDIuMDM0LTAuOTExIDIuMDM0LTIuMDM0LTcuMTA1NDNlLTE1LTEuMTI0LTAuOTEtMi4wMzQtMi4wMzQtMi4wMzR6Ii8+CiAgICA8L2c+CiAgPC9nPgo8L3N2Zz4K"},a="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgICB2aWV3Qm94PSIwIDAgNTAwIDUwMCIgd2lkdGg9IjUwMCIgaGVpZ2h0PSI1MDAiIGlkPSJzdGFydGVyX3N2ZyI+ICAgPC9zdmc+"}(global),function(e){function t(e){return e=String(e||""),e.split("").map(function(e){return void 0!=n[e]?n[e]:e}).join("")}e.toPersianNumber=t;var n={0:"",1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:""}}(global),function(e){function t(e){var t=n[e]||" ";toastr.error(t,"  ",o)}e.sscAlert=t;var n={0:"  ",1:"   ",2:"   ",5:"   ",10:"        ",11:"  ",30:"     ",31:"      ",32:"    ",40:"      ",50:"      ",51:"  ",52:"   ",60:"    ",70:"         ",71:"     ",72:"      ",73:"    ",74:"   ",75:"       ",80:"   ",100:"    ",101:"     ",120:"          ",130:"      "},o={rtl:!0,closeButton:!0,timeOut:1e4,extendedTimeOut:3e3}}(global);var app=angular.module("JavabAzmayesh",["ui.router","vcRecaptcha"]);app.config(["$stateProvider","$urlRouterProvider","$locationProvider","$compileProvider","Config",function(e,t,n,o,r){e.state("start",{url:"/start",template:"",controller:"StartController"}),r.developer_modal&&e.state("developer",{url:"/d",templateUrl:"developer.html",controller:"DeveloperController"}),e.state("home",{url:"/home",views:{"":{templateUrl:"home.html",controller:"HomeController"},menu:{templateUrl:"home/menu.html"},footer:{templateUrl:"home/footer.html"}},abstract:!0}).state("home.find",{url:"/find",templateUrl:"home/find.html",controller:"HomeFindController"}).state("home.otp",{url:"/otp",templateUrl:"home/otp.html",controller:"HomeOtpController"}).state("home.history",{url:"/history",params:{nationalCode:null,otpId:null,requestCode:null},templateUrl:"home/history.html",controller:"HomeHistoryController"}).state("home.about",{url:"/about",params:{previousState:null},templateUrl:"common/about.html",controller:"CommonAboutController",data:{dependencies:["container.rtl.min.css","card.rtl.min.css","image.rtl.min.css"]}}).state("home.contact",{url:"/contact",params:{previousState:null},templateUrl:"common/contact.html",controller:"CommonContactController",data:{dependencies:["container.rtl.min.css"]}}),e.state("history",{url:"/history",params:{nationalCode:null},views:{"":{templateUrl:"history.html",controller:"HistoryController"},header:{templateUrl:"history/header.html"}},data:{dependencies:["card.rtl.min.css"]}}),e.state("answer",{url:"/answer?p&n",params:{previousState:null,previousStateData:null},views:{"":{templateUrl:"answer.html",controller:"AnswerController"},menu:{templateUrl:"answer/menu.html"},header:{templateUrl:"answer/header.html"},footer:{templateUrl:"answer/footer.html"}}}).state("answer.post",{url:"/post",templateUrl:"answer/post.html"}).state("answer.download",{url:"/download",templateUrl:"answer/download.html"}).state("answer.share",{url:"/share",templateUrl:"answer/share.html"}).state("answer.laboratory",{url:"/laboratory",templateUrl:"answer/laboratory.html"}),e.state("lab",{url:"/lab",views:{"":{templateUrl:"lab.html",controller:"LabController"},menu:{templateUrl:"lab/menu.html"},footer:{templateUrl:"lab/footer.html"}},abstract:!0}).state("lab.login",{url:"/login",templateUrl:"lab/login.html",controller:"LabLoginController",data:{dependencies:["checkbox.min.js","checkbox.rtl.min.css"]}}).state("lab.register",{url:"/register",params:{username:null},templateUrl:"lab/register.html",controller:"LabRegisterController",data:{dependencies:["checkbox.min.js","checkbox.rtl.min.css"]}}).state("lab.validate",{url:"/validate",params:{username:null},templateUrl:"lab/validate.html",controller:"LabValidateController"}).state("lab.signedup",{url:"/signedup",templateUrl:"lab/signedup.html"}).state("lab.forget",{url:"/forget",templateUrl:"lab/forget.html",controller:"LabForgetController"}).state("lab.password",{url:"/password",templateUrl:"lab/password.html"}).state("lab.about",{url:"/about",params:{previousState:null},templateUrl:"common/about.html",controller:"CommonAboutController",data:{dependencies:["container.rtl.min.css","card.rtl.min.css","image.rtl.min.css"]}}).state("lab.contact",{url:"/contact",params:{previousState:null},templateUrl:"common/contact.html",controller:"CommonContactController",data:{dependencies:["container.rtl.min.css"]}}),e.state("panel",{url:"/panel",views:{"":{templateUrl:"panel.html",controller:"PanelController"},menu:{templateUrl:"panel/menu.html"},header:{templateUrl:"panel/header.html"}},abstract:!0,data:{dependencies:["loader.rtl.min.css"]}}).state("panel.home",{url:"/home",templateUrl:"panel/home.html",controller:"PanelHomeController",data:{dependencies:["card.rtl.min.css"]}}).state("panel.history",{url:"/history",templateUrl:"panel/history.html",controller:"PanelHistoryController",data:{dependencies:["dropdown.min.js","dropdown.rtl.min.css"]}}).state("panel.post",{url:"/post",templateUrl:"panel/post.html",controller:"PanelPostController"}).state("panel.patient",{url:"/patient",templateUrl:"panel/patient.html",controller:"PanelPatientController"}).state("panel.send",{url:"/send",templateUrl:"panel/send.html",controller:"PanelSendController",data:{dependencies:["progress.min.js","progress.rtl.min.css"]}}).state("panel.balance",{url:"/balance",templateUrl:"panel/balance.html",controller:"PanelBalanceController",data:{dependencies:["statistic.min.css"]}}).state("panel.account",{url:"/account",templateUrl:"panel/account.html",controller:"PanelAccountController",abstract:!0}).state("panel.account.summary",{url:"/summary",templateUrl:"panel/account/summary.html",controller:"PanelAccountSummaryController"}).state("panel.account.edit",{url:"/edit",templateUrl:"panel/account/edit.html",controller:"PanelAccountEditController"}).state("panel.account.password",{url:"/password",templateUrl:"panel/account/password.html",controller:"PanelAccountPasswordController"}).state("panel.account.confirm",{url:"/confirm",params:{action:null},templateUrl:"panel/account/confirm.html",controller:"PanelAccountConfirmController"}),e.state("admin",{url:"/admin",views:{"":{templateUrl:"admin.html",controller:"AdminController"},menu:{templateUrl:"admin/menu.html"},header:{templateUrl:"admin/header.html"}},abstract:!0,data:{dependencies:["loader.rtl.min.css","dropdown.min.js","dropdown.rtl.min.css"]}}).state("admin.home",{url:"/home",templateUrl:"admin/home.html",controller:"AdminHomeController",data:{dependencies:["dygraph.min.js","dygraph.min.css"]}}).state("admin.laboratory",{url:"/laboratory",templateUrl:"admin/laboratory.html",controller:"AdminLaboratoryController"}).state("admin.patient",{url:"/patient",templateUrl:"admin/patient.html",controller:"AdminPatientController"}).state("admin.sms",{url:"/sms",templateUrl:"admin/sms.html",controller:"AdminSmsController",data:{dependencies:["statistic.min.css"]}}),t.otherwise("/home/find"),n.hashPrefix(""),o.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|sms|tg|tel):/)}]),app.run(["$rootScope","$state","$stateParams","$window","$timeout","Config","UserService","DynamicResourceLoader",function(e,t,n,o,r,a,i,s){angular.element("#ja-initial-loader-background").hide(),angular.element("#ja-initial-loader").hide(),angular.element("#ja-main-site-content").show(),angular.element("#ja-sidebar-menu").show(),s("icon-js-feeder.js",function(){r()}),0!==o.location.hash.indexOf("#/answer")&&t.go("start"),e.$state=t,e.$stateParams=n,e.data={};var l=angular.element("head title");l.html(("live"===a.env?"":a.env+" - ")+l.html()),e.$on("$stateChangeStart",function(n,o,r,a,l,u){var c=o.name.split(".").map(function(e,n,o){var r=t.get(o.slice(0,n+1).join("."));return r.data&&r.data.dependencies}).filter(function(e){return!!e}).reduce(function(e,t){return e.concat(t)},[]),d=s(c,!0,function(){d&&t.go(o)});if(d)return void n.preventDefault();0===o.name.indexOf("panel.")?i.current()||(n.preventDefault(),t.go("lab.login")):(delete e.data.postCache,delete e.data.historyState,0===o.name.indexOf("admin.")?i.current()||(n.preventDefault(),t.go("lab.login")):i.current()&&i.logout(!0))}),e.$on("$stateChangeSuccess",function(e,t,n,r,a){o.scrollTo(0,0)}),e.$on("$stateChangeError",function(e,t,n,o,r,a){})}]),app.factory("DynamicResourceLoader",["$timeout",function(e){function t(t,n,o){function r(){(n&&i||"function"==typeof o)&&e(function(){n&&i&&(angular.element("#ja-initial-loader-background").hide(),angular.element("#ja-initial-loader").hide(),angular.element("#ja-main-site-content").show(),angular.element("#ja-sidebar-menu").show()),"function"==typeof o&&o()})}var a=[].concat(t||[]).map(function(e){return"/dist/"+e}),i=0!==a.length;return n&&i&&(angular.element("#ja-initial-loader-background").show(),angular.element("#ja-initial-loader").show(),angular.element("#ja-main-site-content").hide(),angular.element("#ja-sidebar-menu").hide()),i?resourceLoader(a,r):(r(),0)}return t}]),app.factory("Utils",["$q","$http","$window",function(e,t,n){function o(e,t){return e.then(r(t),a)}function r(t){return function(n){return 200!=n.status?(console.log(n.status,n.data),e.reject(1)):0!==n.data.code?("function"==typeof t&&t(n.data),e.reject(n.data.code||1)):n.data}}function a(t){return console.error(t),e.reject(2)}return{httpPromiseHandler:o}}]),app.service("AdminService",["$q","$http","$window","Utils",function(e,t,n,o){function r(){return o.httpPromiseHandler(t.post("/admin/getNotSentSmses",{})).then(function(e){return(e.smsStateStatusList||[]).map(function(e){return e.data.timeStamp=new Date(e.data.timeStamp),e})})}function a(e){return o.httpPromiseHandler(t.post("/admin/tryAgainNotSentSms",{smsKey:e}))}function i(e){return o.httpPromiseHandler(t.post("/admin/checkNotSentSms",{smsKey:e}))}function s(){return o.httpPromiseHandler(t.post("/admin/getNotActivatedLabs",{})).then(function(e){return(e.inactiveLabs||[]).map(function(e){return e.timeStamp=new Date(e.timeStamp),e})})}function l(e){return e.timeStamp=e.timeStamp.getTime(),o.httpPromiseHandler(t.post("/admin/approveInactiveLab",{labData:e}))}function u(e){return o.httpPromiseHandler(t.post("/admin/declineInactiveLab",{labUsername:e}))}function c(){return o.httpPromiseHandler(t.post("/admin/getAllNewC2cPaymentReceipts",{})).then(function(e){return(e.c2cReceiptCodes||[]).map(function(e){return e.timeStamp=new Date(e.timeStamp),e})})}function d(e,n,r){return o.httpPromiseHandler(t.post("/admin/chargeLabFromC2c",{c2cReceiptId:e,labUsername:n,amount:r}))}function f(e){return o.httpPromiseHandler(t.post("/admin/declineC2cReceipt",{c2cReceiptId:e}))}function m(){return o.httpPromiseHandler(t.post("/admin/getNewFeedbacks",{})).then(function(e){return(e.feedbacks||[]).map(function(e){return e.timeStamp=new Date(e.timeStamp),e})})}function p(e){return o.httpPromiseHandler(t.post("/admin/checkFeedback",{feedbackId:e}))}function h(e,n){return o.httpPromiseHandler(t.post("/admin/respondFeedback",{feedbackId:e,message:n}))}function g(){return o.httpPromiseHandler(t.post("/admin/getStatistics",{})).then(function(e){return e.stat||{}})}function v(){return o.httpPromiseHandler(t.post("/admin/getAllLaboratories",{})).then(function(e){return(e.laboratories||[]).map(function(e){return e.timeStamp=new Date(e.timeStamp),e})})}function y(e,n){return o.httpPromiseHandler(t.post("/admin/editLaboratory",{labUsername:e,labData:n}))}function b(e){return o.httpPromiseHandler(t.post("/admin/removeLaboratory",{labUsername:e}))}function w(e){return o.httpPromiseHandler(t.post("/admin/findPatientByNationalCode",{nationalCode:e})).then(function(e){return e.patient})}function S(e,n){return o.httpPromiseHandler(t.post("/admin/sendDummySms",{phoneNumber:String(e),message:n}))}function C(e){return o.httpPromiseHandler(t.post("/admin/broadcastMessage",{message:e}))}function P(){return o.httpPromiseHandler(t.post("/admin/findAllPhoneNumbers"))}function N(){return o.httpPromiseHandler(t.post("/admin/getNikSmsCredit")).then(function(e){return e.credit||0})}this.getNotSentSmses=r,this.tryAgainNotSentSms=a,this.checkNotSentSms=i,this.getNotActivatedLabs=s,this.approveInactiveLab=l,this.declineInactiveLab=u,this.getAllNewC2cPaymentReceipts=c,this.chargeLabFromC2c=d,this.declineC2cReceipt=f,this.getNewFeedbacks=m,this.checkFeedback=p,this.respondFeedback=h,this.getStatistics=g,this.getAllLaboratories=v,this.editLaboratory=y,this.removeLaboratory=b,this.findPatientByNationalCode=w,this.sendDummySms=S,this.broadcastMessage=C,this.findAllPhoneNumbers=P,this.getNikSmsCredit=N}]),app.service("AnswerService",["$q","$http","$window","Utils",function(e,t,n,o){function r(e){return o.httpPromiseHandler(t.post("/answer/patient/info",{nationalCode:e})).then(function(e){return{fullName:e.fullName,numbers:e.numbers||[],email:e.email}})}function a(e,n){return o.httpPromiseHandler(t.post("/answer/patient/update",{person:{nationalCode:e.nationalCode,fullName:e.fullName,mobilePhoneNumber:e.mobilePhoneNumber,phoneNumber:e.phoneNumber,extraPhoneNumber:e.extraPhoneNumber,email:e.email}}),function(e){n&&n(e.errors||{})})}function i(e,n,r,a){return o.httpPromiseHandler(t.post("/answer/send",{timeStamp:Date.now(),person:{nationalCode:e.nationalCode,fullName:e.fullName,mobilePhoneNumber:e.mobilePhoneNumber,phoneNumber:e.phoneNumber,extraPhoneNumber:e.extraPhoneNumber,email:e.email},files:n.map(function(e){return{serverName:e.serverName,name:e.name,size:e.size,type:e.type}}),notes:r}),function(e){a&&a(e.errors||{})})}this.patientInfo=r,this.updatePatient=a,this.send=i}]),app.service("BalanceService",["$q","$http","$window","Utils",function(e,t,n,o){function r(e,n){return o.httpPromiseHandler(t.post("/balance/submit/c2cReceiptCode",{c2cReceiptCode:e}),function(e){n&&n(e.errors||{})})}this.submitC2cReceiptCode=r}]),app.service("HistoryService",["$http","Utils",function(e,t){function n(n,o){return t.httpPromiseHandler(e.post("/history/generate/otp",{nationalCode:n,mobilePhoneNumber:o})).then(function(e){return{otpId:e.otpId,requestCode:e.requestCode}})}function o(n,o,r,a){return t.httpPromiseHandler(e.post("/history/find/history",{nationalCode:n,otpId:o,requestCode:r,otp:a})).then(function(e){return{patientInfo:e.patientInfo,history:e.history}})}function r(n,o){return t.httpPromiseHandler(e.post("/history/load/answer",{nationalCode:n,postCode:o})).then(function(e){return{patientName:e.patientName,postDate:new Date(e.timeStamp),notes:e.notes,files:e.files.map(function(e){return{serverName:e.serverName,name:e.name,size:e.size,type:e.type}}),lab:{name:e.lab.name,mobilePhoneNumber:e.lab.mobilePhoneNumber,phoneNumber:e.lab.phoneNumber,address:e.lab.address,postalCode:e.lab.postalCode,websiteAddress:e.lab.websiteAddress}}})}this.generateOtp=n,this.findHistory=o,this.loadAnswer=r}]),app.service("MasterService",["$q","$http","$window","Utils",function(e,t,n,o){function r(e,n,r){return o.httpPromiseHandler(t.post("/master/send/feedback",{mobilePhoneNumber:e,message:n}),function(e){r&&r(e.errors||{})})}this.sendFeedback=r}]),app.service("PostService",["$q","$http","Utils",function(e,t,n){function o(e,o){return n.httpPromiseHandler(t.post("/post/load/all",{year:e,months:o})).then(function(e){var t=e.postPacks||{};for(var n in t){var o=t[n]||"",r=o.split("|").filter(function(e){return!!e}).map(function(e){return{nationalCode:e.slice(0,10),filesCount:Number(e.slice(10,12)),postCode:e.slice(12,16),postDate:new Date(Number(e.slice(16,29)))}});t[n]=r}return t})}function r(e,o){return n.httpPromiseHandler(t.post("/post/load/one",{nationalCode:e,postCode:o})).then(function(e){return{fullName:e.fullName,nationalCode:e.nationalCode,numbers:e.numbers||[],email:e.email,postCode:e.postCode,postDate:new Date(e.timeStamp),notes:e.notes,files:e.files||[]}})}function a(e,o){return n.httpPromiseHandler(t.post("/post/delete/one",{nationalCode:e,postCode:o}))}function i(e,o,r){return n.httpPromiseHandler(t.post("/post/update/one",{nationalCode:e,postCode:o,postData:r}))}this.getPosts=o,this.getOnePost=r,this.deleteOnePost=a,this.updateOnePost=i}]),app.service("UserService",["$q","$http","$window","Utils",function(e,t,n,o){function r(e,n){return o.httpPromiseHandler(t.post("/user/register",{userData:{labName:e.labName,mobilePhoneNumber:e.mobilePhoneNumber,phoneNumber:e.phoneNumber,address:e.address,postalCode:e.postalCode,websiteAddress:e.websiteAddress,username:e.username,password:e.password},recaptcha:e.response}),function(e){n&&n(e.errors||{})})}function a(e,n){return o.httpPromiseHandler(t.post("/user/register/confirm",{username:e,validationCode:n}))}function i(e,n){return o.httpPromiseHandler(t.post("/user/edit/account",{newAccount:{labName:e.labName,mobilePhoneNumber:e.mobilePhoneNumber,phoneNumber:e.phoneNumber,address:e.address,postalCode:e.postalCode,websiteAddress:e.websiteAddress}}),function(e){n&&n(e.errors||{})})}function s(e,n,r){return o.httpPromiseHandler(t.post("/user/edit/password",{oldPassword:e,newPassword:n}),function(e){r&&r(e.errors||{})})}function l(e,n){return o.httpPromiseHandler(t.post("/user/edit/confirm",{username:e,validationCode:n})).then(function(e){var t=e.userInfo;return v(void 0,t),y(t)})}function u(e,r,a){return o.httpPromiseHandler(t.post("/user/login",{username:e,password:r,rememberMe:a})).then(function(e){var t=e.accessKey,o=e.userInfo;return v(t,o),a?n.localStorage.CurrentUser=n.sessionStorage.CurrentUser:n.localStorage.removeItem("CurrentUser"),y(o)})}function c(){return null===f()?e.reject(50):o.httpPromiseHandler(t.post("/user/refresh",{})).then(function(e){var t=e.userInfo;return v(void 0,t),y(t)})}function d(o){return delete t.defaults.headers.common["X-Access-Token"],delete n.sessionStorage.CurrentUser,o||delete n.localStorage.CurrentUser,e.when()}function f(){try{var e=n.sessionStorage.CurrentUser;if(!e)return null;var t=JSON.parse(e);if(!t)return null;return y(t.userInfo)||null}catch(e){return null}}function m(e,n){return o.httpPromiseHandler(t.post("/user/restorePassword",{username:e,mobilePhoneNumber:n}))}function p(){try{var e=n.sessionStorage.CurrentUser;if(!e)return null;return JSON.parse(e)||null}catch(e){return null}}function h(e){e&&v(e.accessKey,e.userInfo)}function g(){try{var e=n.localStorage.CurrentUser;if(!e)return null;return JSON.parse(e)||null}catch(e){return null}}function v(e,o){var r;try{r=JSON.parse(n.sessionStorage.CurrentUser||"{}")||{}}catch(e){r={}}void 0!==e&&(r.accessKey=e,t.defaults.headers.common["X-Access-Token"]=e),void 0!==o&&(r.userInfo=o),n.sessionStorage.CurrentUser=JSON.stringify(r)}function y(e){return e&&(e.subscriptionDate=new Date(e.timeStamp)),e}this.register=r,this.registerConfirm=a,this.editAccount=i,this.editPassword=s,this.editConfirm=l,this.login=u,this.refresh=c,this.logout=d,this.current=f,this.restorePassword=m,this.getUserSession=p,this.setUserSession=h,this.getUserPersistent=g}]),app.controller("AdminHomeController",["$scope","$rootScope","$state","$stateParams","$timeout","UserService","AdminService",function(e,t,n,o,r,a,i){var s=a.current();e.setPageTitle(s&&s.fullName||" "),e.setBackHandler(e.menuHandlers.logout),e.submenus=[" ","   ","   ","      ","    ","   "],e.selectedSubmenu=0,e.selectedSubmenuText=e.submenus[0],$("#ja-admin-home-submenu-selector").dropdown({onChange:function(t,n){r(function(){e.selectedSubmenu=t,e.selectedSubmenuText=n})}}).dropdown("set selected",0)}]),app.controller("AdminLaboratoryController",["$scope","$rootScope","$state","$stateParams","UserService","AdminService",function(e,t,n,o,r,a){function i(t){e.selectedLab=t,e.selectedLabIndex=e.laboratories.indexOf(t),e.editingLab=angular.copy(t),e.updating=!1,u=$("#ja-admin-laboratory-edit-modal").modal({closable:!1,onApprove:function(){return e.updating=!0,a.editLaboratory(t.username,e.editingLab).then(function(){e.laboratories[e.selectedLabIndex]=e.editingLab,e.selectedLab=e.editingLab,u.modal("hide")},function(t){e.updating=!1,sscAlert(t)}),!1},onDeny:function(){}}).modal("show")}function s(){var t=Number(e.charge||"");t&&(e.editingLab.balance=Number(e.editingLab.balance)+t,e.charge="")}function l(){if(e.labNameAgain!==e.editingLab.labName)return void alert("     .\n            .");e.updating=!0,a.removeLaboratory(e.editingLab.username).then(function(){e.laboratories.splice(e.selectedLabIndex,1),e.selectedLab=null,e.selectedLabIndex=-1,u.modal("hide")},function(t){e.updating=!1,sscAlert(t)})}e.setPageTitle(" "),e.setBackHandler(e.menuHandlers.goToMainPage),e.selectLab=i,e.chargeLab=s,e.removeLab=l,e.laboratories=[],e.selectedLab=null,e.setLoading(!0),a.getAllLaboratories().then(function(t){e.laboratories=t,e.setLoading(!1)},function(t){sscAlert(t),e.setLoading(!1)});var u}]),app.controller("AdminPatientController",["$scope","$rootScope","$state","$stateParams","UserService","AdminService",function(e,t,n,o,r,a){function i(){e.nationalCode&&(e.searching=!0,e.showResult,a.findPatientByNationalCode(e.nationalCode).then(function(t){e.patient=t,e.showResult=!0},function(t){e.showResult=!1,sscAlert(t)}).then(function(){e.searching=!1}))}e.setPageTitle(""),e.setBackHandler(e.menuHandlers.goToMainPage),e.findPatientByNationalCode=i,e.searching=!1,e.showResult=!1}]),app.controller("AdminSmsController",["$scope","$rootScope","$state","$timeout","$stateParams","UserService","AdminService",function(e,t,n,o,r,a,i){function s(){e.waiting=!0,i.getNikSmsCredit().then(function(t){e.credit=Math.floor(t)},function(e){sscAlert(e)}).then(function(){e.waiting=!1})}function l(){e.waiting=!0,i.sendDummySms(e.phoneNumber,e.message).catch(function(e){sscAlert(e)}).then(function(){e.waiting=!1})}function u(){e.messageToBroadcast&&e.showConfirmMessage("     ","                .\n     ","  ","  ","red","basic green").then(function(){e.showConfirmMessage("     ","                ","","","red","basic green").then(function(){e.waiting=!0,i.broadcastMessage(e.messageToBroadcast).catch(function(e){sscAlert(e)}).then(function(){e.waiting=!1})})})}function c(){e.waiting=!0,i.findAllPhoneNumbers().then(function(){e.areAllPhoneNumbersReady=!0},function(e){sscAlert(e)}).then(function(){e.waiting=!1})}e.setPageTitle(" "),e.setBackHandler(e.menuHandlers.goToMainPage),e.submenus=["     ","  ","     ","      "],e.selectedSubmenu=0,e.selectedSubmenuText=e.submenus[0],$("#ja-admin-sms-submenu-selector").dropdown({onChange:function(t,n){o(function(){e.selectedSubmenu=t,e.selectedSubmenuText=n,0==e.selectedSubmenu&&s()})}}).dropdown("set selected",0),e.waiting=!1,e.sendDummySms=l,e.broadcastMessage=u,e.findAllPhoneNumbers=c,e.message="   \nJavabAzmayesh.ir",e.messageToBroadcast="     !\n ...\nJavabAzmayesh.ir",e.areAllPhoneNumbersReady=!1,s()}]),app.controller("CommonAboutController",["$scope","$state","$stateParams",function(e,t,n){e.previousState=n.previousState,e.setBackHandler(function(){t.go(e.previousState)}),e.people=[{name:"  ",description:"        ",title:"   ",img:"/img/about/negar.png",color:"teal"},{name:" ",description:"      ",title:"   ",img:"/img/about/mehrnoosh.png",color:"green"},{name:"   ",description:"        ",title:"   ",img:"/img/about/hessam.png",color:"blue"}]}]),app.controller("CommonContactController",["$scope","$state","$stateParams","MasterService",function(e,t,n,o){function r(){e.vs.validate()&&(e.sendingFeedback=!0,o.sendFeedback(e.mobilePhoneNumber,e.message,e.vs.dictate).then(function(){e.sendingFeedback=!1,e.showMessage("   ","    .\n       .\n         .").then(function(){delete e.message})},function(t){e.sendingFeedback=!1,sscAlert(t)}))}e.sendFeedback=r,e.sendingFeedback=!1,e.previousState=n.previousState,e.setBackHandler(function(){t.go(e.previousState)}),e.vs=new ValidationSystem(e).field("mobilePhoneNumber",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.mobilePhoneNumber()]).field("message",[ValidationSystem.validators.notEmpty()])}]),app.controller("HomeFindController",["$rootScope","$scope","$state","$timeout",function(e,t,n,o){function r(){t.vs.validate()&&n.go("answer",{p:t.nationalCode,n:t.postCode,previousState:"home.find",previousStateData:null})}t.seeAnswer=r,t.findingAnswer=!1,localStorage.startState="home.find",t.setBackHandler(!1),t.vs=new ValidationSystem(t).field("nationalCode",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.nationalCode()]).field("postCode",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.numberCode(4)])}]),app.controller("HomeHistoryController",["$rootScope","$scope","$state","$stateParams","$timeout","HistoryService",function(e,t,n,o,r,a){function i(){t.vs.validate()&&(t.findingHistory=!0,a.findHistory(t.nationalCode,s,l,t.otp).then(function(o){e.data.patientInfo=o.patientInfo,e.data.history=o.history,n.go("history",{nationalCode:t.nationalCode})},function(e){t.findingHistory=!1,sscAlert(e)}))}t.findHistory=i,t.nationalCode=o.nationalCode;var s=o.otpId,l=o.requestCode;t.findingHistory=!1,t.setBackHandler(function(){n.go("home.otp")}),t.vs=new ValidationSystem(t).field("otp",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.numberCode(6)])}]),app.controller("HomeOtpController",["$rootScope","$scope","$state","$timeout","HistoryService",function(e,t,n,o,r){function a(){t.vs.validate()&&(t.sendingOtp=!0,r.generateOtp(t.nationalCode,t.mobilePhoneNumber).then(function(e){n.go("home.history",{nationalCode:t.nationalCode,otpId:e.otpId,requestCode:e.requestCode})},function(e){t.sendingOtp=!1,sscAlert(e)}))}t.sendOtp=a,t.sendingOtp=!1,t.setBackHandler(function(){n.go("home.find")}),t.vs=new ValidationSystem(t).field("nationalCode",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.nationalCode()]).field("mobilePhoneNumber",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.mobilePhoneNumber()])}]),app.controller("LabForgetController",["$rootScope","$scope","$state","$timeout","UserService",function(e,t,n,o,r){function a(){if(t.vs.validate())return t.restoringPassword=!0,r.restorePassword(t.username,t.mobilePhoneNumber).then(function(){n.go("lab.password")},function(e){t.restoringPassword=!1,sscAlert(e)})}t.restorePassword=a,t.restoringPassword=!1,t.setBackHandler(function(){n.go("lab.login")}),t.vs=new ValidationSystem(t).field("username",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.username(),ValidationSystem.validators.minLength(4)]).field("mobilePhoneNumber",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.mobilePhoneNumber()])}]),app.controller("LabLoginController",["$rootScope","$scope","$state","UserService",function(e,t,n,o){function r(){if(t.vs.validate())return t.loggingIn=!0,o.login(t.username,t.password,t.rememberMe).then(a,function(e){t.loggingIn=!1,sscAlert(e)})}function a(t){"laboratory"===t.userType?(e.data.labData=t,n.go("panel.home")):"administrator"===t.userType&&(e.data.adminData=t,n.go("admin.home"))}t.login=r,t.loggingIn=!1,localStorage.startState="lab.login"
;var i=o.getUserPersistent();if(console.log(i),i)return o.setUserSession(i),void a(i.userInfo);t.setBackHandler(!1),t.vs=new ValidationSystem(t).field("username",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.username(),ValidationSystem.validators.minLength(4)]).field("password",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.minLength(4)])}]),app.controller("LabRegisterController",["$rootScope","$scope","$state","$stateParams","$timeout","vcRecaptchaService","UserService","Config",function(e,t,n,o,r,a,i,s){function l(e){t.response=e}function u(e){t.widgetId=e}function c(){s.google_recaptcha&&a.reload(t.widgetId),t.response=null}function d(){if(t.vs.validate())return t.sendingRegisterationForm=!0,s.google_recaptcha&&(t.model.response=t.response),i.register(t.model,t.vs.dictate).then(function(){n.go("lab.validate",{username:t.model.username})},function(e){t.sendingRegisterationForm=!1,sscAlert(e),s.google_recaptcha&&a.reload(t.widgetId)})}t.setResponse=l,t.setWidgetId=u,t.cbExpiration=c,t.sendRegisterationForm=d,t.showGoogleRecaptcha=s.google_recaptcha,t.key=s.google_recaptcha_public_key,t.sendingRegisterationForm=!1,t.model={},t.model.username=o.username,t.setBackHandler(function(){n.go("lab.login")}),t.vs=new ValidationSystem(t.model).field("labName",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.minLength(5)]).field("mobilePhoneNumber",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.mobilePhoneNumber()]).field("phoneNumber",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.phoneNumber()]).field("address",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.minLength(10)]).field("postalCode",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.integer(),ValidationSystem.validators.length(10)]).field("websiteAddress",[ValidationSystem.validators.notRequired(),ValidationSystem.validators.minLength(5),ValidationSystem.validators.url()]).field("username",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.username(),ValidationSystem.validators.minLength(4)]).field("password",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.minLength(4),function(e){if(t.model.passwordAgain&&t.model.passwordAgain!=e)return"      "}]).field("passwordAgain",[function(e){if(!t.model.password)return!0},ValidationSystem.validators.notEmpty(),ValidationSystem.validators.minLength(4),function(e){if(t.model.password!=e)return"      "}]).field("acceptRules",[ValidationSystem.validators.notEmpty("     ")])}]),app.controller("LabValidateController",["$rootScope","$scope","$state","$stateParams","UserService",function(e,t,n,o,r){function a(){if(t.vs.validate())return t.confirmingRegisteration=!0,r.registerConfirm(t.username,t.validationCode).then(function(){t.confirmingRegisteration=!1,n.go("lab.signedup")},function(e){t.confirmingRegisteration=!1,sscAlert(e)})}t.confirmRegisteration=a,t.username=o.username,t.confirmingRegisteration=!1,t.setBackHandler(function(){n.go("lab.register",{username:t.username})}),t.vs=new ValidationSystem(t).field("validationCode",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.numberCode(4)])}]),app.controller("PanelAccountController",["$scope","$rootScope","$state","$stateParams",function(e,t,n,o){}]),app.controller("PanelBalanceController",["$scope","$rootScope","$state","$stateParams","$timeout","Config","BalanceService",function(e,t,n,o,r,a,i){function s(){e.vs.validate("c2cReceiptCode")&&(e.preparingPayment=!0,i.submitC2cReceiptCode(e.c2cReceiptCode,e.vs.dictate).then(function(){e.preparingPayment=!1,e.showMessage("   ","               .").then(function(){n.go("panel.home")})},function(t){e.preparingPayment=!1,sscAlert(t)}))}function l(){}e.c2cPayment=s,e.zpPayment=l,e.balance=t.data.labData.balance||0,e.preparingPayment=!1,e.setBackHandler(function(){n.go("panel.home")}),e.setPageTitle("    "),e.vs=new ValidationSystem(e).field("c2cReceiptCode",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.minLength(4),ValidationSystem.validators.integer()]).field("zpChargeAmount",[]),e.testCount=Math.floor(e.balance/a.post_price),e.balanceForDisplay=toPersianNumber(e.balance),e.testCountForDisplay=e.testCount>0?toPersianNumber(e.testCount):"",e.testCount>=200?e.balanceColor="green":e.testCount>=50?e.balanceColor="olive":e.testCount>=20?e.balanceColor="yellow":e.testCount>0?e.balanceColor="orange":e.balanceColor="red"}]),app.controller("PanelHistoryController",["$scope","$rootScope","$state","$stateParams","$timeout","$window","UserService","PostService",function(e,t,n,o,r,a,i,s){function l(e){g.scrollY=a.scrollY}function u(t){e.setLoading(!0);var n=v[e.selectedYear]=v[e.selectedYear]||[],o=Array.range(e.selectedMonthFrom,e.selectedMonthTo),r=o.filter(function(e){return!n[e]});t&&e.selectedYear==p&&o.indexOf(h)>=0&&r.indexOf(h)<0&&r.push(h);var a;return a=Object.keys(r).length?s.getPosts(e.selectedYear,r).catch(function(e){sscAlert(e)}):Promise.resolve({}),a.then(function(t){e.posts=[];for(var r=12;r>=1;r--)o.indexOf(r)>=0&&(n[r]=t[e.selectedYear+"/"+r]||n[r]||[],e.posts=e.posts.concat(n[r]))}).then(function(){e.setLoading(!1)})}function c(e){t.data.post=e,n.go("panel.post")}e.postClicked=c,e.maxCount=500;var d=i.current(),f=d.subscriptionDate.jYMD()[0],m=(new Date).jYMD(),p=m[0],h=m[1];e.allYears=Array.range(p,f),e.persianMonths=["","","","","","","","","","","",""];var g=t.data.historyState=t.data.historyState||{};e.nationalCode=g.nationalCode,e.selectedYear=g.selectedYear||e.allYears[0],e.selectedMonthFrom=g.selectedMonthFrom||h,e.selectedMonthFromText=e.persianMonths[e.selectedMonthFrom-1],e.selectedMonthTo=g.selectedMonthTo||h,e.selectedMonthToText=e.persianMonths[e.selectedMonthTo-1];var v=t.data.postCache=t.data.postCache||[];e.posts=[],u(!0).then(function(){r(function(){a.scrollTo(a.scrollX,g.scrollY)})}),e.$watch("nationalCode",function(){g.nationalCode=e.nationalCode}),a.addEventListener("scroll",l),e.$on("$destroy",function(){a.removeEventListener("scroll",l)}),e.setBackHandler(function(){n.go("panel.home")}),e.setPageTitle("   "),angular.element("#select-year").dropdown({onChange:function(t,n){e.selectedYear=g.selectedYear=t,u()}}),angular.element("#select-month-from").dropdown({onChange:function(t,n){t=Number(t),e.selectedMonthFrom=g.selectedMonthFrom=t,e.selectedMonthFromText=e.persianMonths[t-1];var o=e.selectedMonthTo>e.selectedMonthFrom?e.selectedMonthTo:e.selectedMonthFrom;o!=e.selectedMonthTo&&angular.element("#select-month-to").dropdown("set selected",e.selectedMonthTo=g.selectedMonthTo=o),u()}}),angular.element("#select-month-to").dropdown({onChange:function(t,n){t=Number(t),e.selectedMonthTo=g.selectedMonthTo=t,e.selectedMonthToText=e.persianMonths[t-1];var o=e.selectedMonthFrom<e.selectedMonthTo?e.selectedMonthFrom:e.selectedMonthTo;o!=e.selectedMonthFrom&&angular.element("#select-month-from").dropdown("set selected",e.selectedMonthFrom=g.selectedMonthFrom=o),u()}})}]),app.controller("PanelHomeController",["$scope","$rootScope","$state","$stateParams","UserService",function(e,t,n,o,r){e.setBackHandler(e.menuHandlers.logout);var a=r.current();e.setPageTitle(a&&a.labName||" ")}]),app.controller("PanelPatientController",["$scope","$rootScope","$state","$stateParams","$window","$timeout","$http","AnswerService",function(e,t,n,o,r,a,i,s){function l(){if(e.vs.see("nationalCode")&&!(e.person.fullName&&e.person.mobilePhoneNumber&&e.person.phoneNumber&&e.person.extraPhoneNumber&&e.person.email))return e.updatingPatient=!0,s.patientInfo(e.person.nationalCode).then(function(t){e.person.fullName=e.person.fullName||t.fullName,e.person.mobilePhoneNumber=e.person.mobilePhoneNumber||t.numbers[0],e.person.phoneNumber=e.person.phoneNumber||t.numbers[1],e.person.extraPhoneNumber=e.person.extraPhoneNumber||t.numbers[2],e.person.email=e.person.email||t.email,e.vs.check("fullName","mobilePhoneNumber","phoneNumber","extraPhoneNumber","email")},function(e){}).then(function(){e.updatingPatient=!1})}function u(){e.vs.validate()&&(e.updatingPatient=!0,s.updatePatient(e.person,e.vs.dictate).then(function(){e.updatingPatient=!1,e.showMessage("    ","         .").then(function(){n.go("panel.home")})},function(t){e.updatingPatient=!1,sscAlert(t)}))}e.loadPatientInfo=l,e.updatePatient=u,e.updatingPatient=!1,e.setBackHandler(function(){n.go("panel.home")}),e.setPageTitle(" "),e.person={},e.vs=new ValidationSystem(e.person).field("nationalCode",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.nationalCode()]).field("fullName",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.minLength(3)]).field("mobilePhoneNumber",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.mobilePhoneNumber()]).field("phoneNumber",[ValidationSystem.validators.notRequired(),ValidationSystem.validators.phoneNumber()]).field("extraPhoneNumber",[ValidationSystem.validators.notRequired(),ValidationSystem.validators.phoneNumber()]).field("email",[ValidationSystem.validators.notRequired(),ValidationSystem.validators.email()])}]),app.controller("PanelPostController",["$scope","$rootScope","$state","$stateParams","$q","PostService","UserService",function(e,t,n,o,r,a,i){function s(){n.go("answer",{p:e.post.nationalCode,n:e.post.postCode,previousState:"panel.post",previousStateData:{postCache:t.data.postCache,historyState:t.data.historyState,panelPostData:e.post,userSession:i.getUserSession()}})}function l(){}function u(){e.showConfirmMessage("   ","              ","  ","  ","red","basic green").then(function(){e.setLoading(!0),a.deleteOnePost(c.nationalCode,c.postCode).then(function(){e.showMessage("     ","               .").then(function(){delete t.data.postCache,n.go("panel.history")})},function(e){sscAlert(e)}).then(function(){e.setLoading(!1)})})}e.seePostAsPatient=s,e.updatePost=l,e.deletePost=u;var c=t.data.post;e.setBackHandler(function(){n.go("panel.history")}),e.setPageTitle("   ..."),e.$on("$destroy",function(){delete t.data.panelPostData}),e.setLoading(!0),(t.data.panelPostData?r.when(t.data.panelPostData):a.getOnePost(c.nationalCode,c.postCode)).then(function(n){n.files=n.files||[],n.files.forEach(function(e){e.url="/answer/file/download?p="+n.nationalCode+"&n="+n.postCode+"&f="+e.serverName,e.type.indexOf("image")>=0?e.material="image":"application/pdf"===e.type&&(e.material="pdf")}),e.post=n,t.data.panelPostData=n,e.setPageTitle(e.post.fullName),e.postDataForDisplay=[{label:" ",value:toPersianNumber(n.fullName)},{label:"  ",value:toPersianNumber(n.nationalCode)},{label:"   ",value:toPersianNumber(n.numbers.join(" - "))},{label:"   ",value:n.email},{label:" ",value:toPersianNumber(n.postCode)},{label:"   ",value:persianDate(n.postDate).format("L")},{label:"   ",value:toPersianNumber(n.files.length)}]},function(e){sscAlert(e)}).then(function(){e.setLoading(!1)})}]),app.controller("PanelSendController",["$scope","$rootScope","$state","$stateParams","$window","$timeout","$http","AnswerService",function(e,t,n,o,r,a,i,s){function l(){if(e.vs.see("nationalCode")&&!(e.person.fullName&&e.person.mobilePhoneNumber&&e.person.phoneNumber&&e.person.extraPhoneNumber&&e.person.email))return e.sendingAnswer=!0,s.patientInfo(e.person.nationalCode).then(function(t){e.person.fullName=e.person.fullName||t.fullName,e.person.mobilePhoneNumber=e.person.mobilePhoneNumber||t.numbers[0],e.person.phoneNumber=e.person.phoneNumber||t.numbers[1],e.person.extraPhoneNumber=e.person.extraPhoneNumber||t.numbers[2],e.person.email=e.person.email||t.email,e.vs.check("fullName","mobilePhoneNumber","phoneNumber","extraPhoneNumber","email")},function(e){}).then(function(){e.sendingAnswer=!1})}function u(){e.vs.validate()&&(e.sendingAnswer=!0,s.send(e.person,e.files,e.notes,e.vs.dictate).then(function(){return e.refreshUserData()}).then(function(){e.sendingAnswer=!1,e.showMessage("    ","            .").then(function(){n.go("panel.home")})},function(t){e.sendingAnswer=!1,sscAlert(t)}))}function c(){S.click()}function d(e){var t=w(S.files);S.value="",g(t)}function f(e){C.className="dragover"===e.type&&e.path.indexOf(C)>=0?"drag-on":"",e.stopPropagation(),e.preventDefault()}function m(e){f(e)}function p(e){f(e)}function h(e){if(f(e),e.path.indexOf(C)>=0){g(w(e.target.files||e.dataTransfer.files))}}function g(t){t=t.filter(function(t){return t.size>0&&t.size<=10485760&&""!=t.type&&0===e.files.filter(function(e){return e.name===t.name&&e.size===t.size&&e.type===t.type&&e.lastModified===t.lastModified}).length}),t.forEach(function(e){if(e.id=P++,e.srcPreview=iconJs.file(e.name),e.type.match("image.*")){var t=new FileReader;t.onload=function(t){a(function(){e.srcPreview=t.target.result})},t.readAsDataURL(e)}}),t.forEach(v),e.files=e.files.concat(t),e.$$phase||e.$apply()}function v(t){t.status="Preparing";var n=new FormData;n.append(t.name,t);var o=new XMLHttpRequest;t.xhr=o,o.open("post","/answer/file/upload",!0),o.setRequestHeader("X-Access-Token",i.defaults.headers.common["X-Access-Token"]),o.upload.onprogress=function(n){n.lengthComputable&&(t.progress=Math.floor(n.loaded/n.total*100),angular.element("#progress-"+t.id).progress({percent:t.progress}),e.$$phase||e.$apply())},o.onerror=function(n){t.status="Error",e.$$phase||e.$apply()},o.onabort=function(n){"Aborting"===t.status&&(t.status="Aborted"),e.$$phase||e.$apply()},o.onload=function(n){try{if(200!=n.currentTarget.status)throw n.currentTarget.response;t.serverName=JSON.parse(n.currentTarget.response).filename,t.status="Uploaded"}catch(e){t.status="Error"}e.$$phase||e.$apply()},t.status="Uploading",t.progress=0,angular.element("#progress-"+t.id).progress({percent:t.progress}),e.$$phase||e.$apply(),o.send(n)}function y(e){e.status="Aborting",e.xhr.abort()}function b(t){y(t),t.status="Removing",a(function(){t.status="Removed",e.files.splice(e.files.indexOf(t),1)})}function w(e){return Array.apply(null,{length:e.length}).map(Number.call,Number).map(function(t){return e[t]})}e.loadPatientInfo=l,e.sendAnswer=u,e.selectFilesDialog=c,e.abortUpload=y,e.removeFile=b,e.sendingAnswer=!1,e.files=[],e.setBackHandler(function(){n.go("panel.home")}),e.setPageTitle(" ");var S=r.document.getElementById("input-file"),C=r.document.getElementById("drop-zone");S.addEventListener("change",d,!1),r.document.addEventListener("dragover",m,!1),r.document.addEventListener("dragleave",p,!1),r.document.addEventListener("drop",h,!1),e.$on("$destroy",function(){S.removeEventListener("change",d),r.document.removeEventListener("dragover",m),r.document.removeEventListener("dragleave",p),r.document.removeEventListener("drop",h)}),e.person={},e.vs=new ValidationSystem(e.person).field("nationalCode",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.nationalCode()]).field("fullName",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.minLength(3)]).field("mobilePhoneNumber",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.mobilePhoneNumber()]).field("phoneNumber",[ValidationSystem.validators.notRequired(),ValidationSystem.validators.phoneNumber()]).field("extraPhoneNumber",[ValidationSystem.validators.notRequired(),ValidationSystem.validators.phoneNumber()]).field("email",[ValidationSystem.validators.notRequired(),ValidationSystem.validators.email()]);var P=0}]),app.controller("AdminHomeNewC2cPaymentCodesController",["$scope","$rootScope","$state","$stateParams","AdminService",function(e,t,n,o,r){function a(){e.setLoading(!0),r.getAllNewC2cPaymentReceipts().then(function(t){e.c2cPaymentCodes=t},function(e){sscAlert(e)}).then(function(){e.setLoading(!1)})}function i(t,n){null===e.selectedC2c?(delete e.selectedC2c,delete e.selectedC2cIndex):e.selectedC2cIndex!==n&&(e.selectedC2c=t,e.selectedC2cIndex=n)}function s(){e.selectedC2c=null,e.selectedC2cIndex=null}function l(t){var n=Number(t||"");n&&(e.updating=!0,r.chargeLabFromC2c(e.selectedC2c.id,e.selectedC2c.username,n).then(function(){e.c2cPaymentCodes.splice(e.selectedC2cIndex,1),delete e.selectedC2c,delete e.selectedC2cIndex},function(e){sscAlert(e)}).then(function(){e.updating=!1}))}function u(){e.showConfirmMessage("    ","               .\n     ","  ","  ","red","basic green").then(function(){e.updating=!0,r.declineC2cReceipt(e.selectedC2c.id).then(function(){e.c2cPaymentCodes.splice(e.selectedC2cIndex,1),delete e.selectedC2c,delete e.selectedC2cIndex},function(e){sscAlert(e)}).then(function(){e.updating=!1})})}e.getAllNewC2cPaymentReceipts=a,e.openC2c=i,e.closeSelectedC2c=s,e.chargeLab=l,e.declineC2c=u,a()}]),app.controller("AdminHomeNewFeedbacksController",["$scope","$rootScope","$state","$stateParams","AdminService",function(e,t,n,o,r){function a(){e.setLoading(!0),r.getNewFeedbacks().then(function(t){e.feedbacks=t},function(e){sscAlert(e)}).then(function(){e.setLoading(!1)})}function i(t,n){null===e.selectedFb?(delete e.selectedFb,delete e.selectedFbIndex):e.selectedFbIndex!==n&&(e.selectedFb=t,e.selectedFbIndex=n,e.respondMessage="!\n   .\n             .")}function s(){e.selectedFb=null,e.selectedFbIndex=null}function l(){e.showConfirmMessage("    ","          .\n               ","  ","  ","orange","basic green").then(function(){e.updating=!0,r.checkFeedback(e.selectedFb.id).then(function(){e.feedbacks.splice(e.selectedFbIndex,1),delete e.selectedFb,delete e.selectedFbIndex},function(e){sscAlert(e)}).then(function(){e.updating=!1})})}function u(){e.updating=!0,r.respondFeedback(e.selectedFb.id,e.respondMessage).then(function(){e.feedbacks.splice(e.selectedFbIndex,1),delete e.selectedFb,delete e.selectedFbIndex},function(e){sscAlert(e)}).then(function(){e.updating=!1})}e.getNewFeedbacks=a,e.openFb=i,e.closeSelectedFb=s,e.checkFb=l,e.respondFb=u,a()}]),app.controller("AdminHomeNotActivatedLabsController",["$scope","$rootScope","$state","$stateParams","AdminService",function(e,t,n,o,r){function a(){e.setLoading(!0),r.getNotActivatedLabs().then(function(t){e.inactiveLabs=t},function(e){sscAlert(e)}).then(function(){e.setLoading(!1)})}function i(t,n){null===e.selectedLab?(delete e.selectedLab,delete e.selectedLabIndex):e.selectedLabIndex!==n&&(e.selectedLab=angular.copy(t),e.selectedLabIndex=n)}function s(){e.selectedLab=null,e.selectedLabIndex=null}function l(){e.showConfirmMessage("  ","      ","  ","","green","basic gray").then(function(){e.updating=!0,r.approveInactiveLab(e.selectedLab).then(function(){e.inactiveLabs.splice(e.selectedLabIndex,1),delete e.selectedLab,delete e.selectedLabIndex},function(e){sscAlert(e)}).then(function(){e.updating=!1})})}function u(){e.showConfirmMessage("    ","           \n       .","  ","  ","red","basic green").then(function(){e.updating=!0,r.declineInactiveLab(e.selectedLab.username).then(function(){e.inactiveLabs.splice(e.selectedLabIndex,1),delete e.selectedLab,delete e.selectedLabIndex},function(e){sscAlert(e)}).then(function(){e.updating=!1})})}e.getNotActivatedLabs=a,e.openLab=i,e.closeSelectedLab=s,e.approveLab=l,e.declineLab=u,a()}]),app.controller("AdminHomeNotDeliveredSmsesController",["$scope","$rootScope","$state","$stateParams","AdminService",function(e,t,n,o,r){function a(){e.setLoading(!0),r.getNotSentSmses().then(function(t){e.notDeliveredSmses=t},function(e){sscAlert(e)}).then(function(){e.setLoading(!1)})}function i(t,n){null===e.selectedSms?(delete e.selectedSms,delete e.selectedSmsIndex):(e.selectedSms=t,e.selectedSmsIndex=n)}function s(){e.selectedSms=null,e.selectedSmsIndex=null}function l(){e.updating=!0,r.tryAgainNotSentSms(e.selectedSms.data.smsKey).then(function(){e.notDeliveredSmses.splice(e.selectedSmsIndex,1),delete e.selectedSms,delete e.selectedSmsIndex},function(e){sscAlert(e)}).then(function(){e.updating=!1})}function u(){e.updating=!0,r.checkNotSentSms(e.selectedSms.data.smsKey).then(function(){e.notDeliveredSmses.splice(e.selectedSmsIndex,1),delete e.selectedSms,delete e.selectedSmsIndex},function(e){sscAlert(e)}).then(function(){e.updating=!1})}function c(e,t){return"sms:"+e+";?&"+simpleQueryString.stringify({body:t})}function d(){m.message||(m.message=new Clipboard("#ja-copy-message"),m.message.on("success",function(e){console.info("Success",e.action,e.text),e.clearSelection()}),m.message.on("error",function(e){console.info("Error",e.action,e.text)}))}function f(e){e=String(e),m[e]||(m[e]=new Clipboard("#ja-copy-number-"+e),m[e].on("success",function(e){console.info("Success",e.action,e.text),e.clearSelection()}),m[e].on("error",function(e){console.info("Error",e.action,e.text)}))}e.getNotSentSmses=a,e.openSms=i,e.closeSelectedSms=s,e.sendSmsAgain=l,e.checkSelectedSms=u,e.makeSmsHref=c,e.copyMessage=d,e.copyNumber=f;var m={};a()}]),app.controller("AdminHomeStatisticsController",["$scope","$rootScope","$state","$stateParams","AdminService",function(e,t,n,o,r){function a(){e.setLoading(!0),r.getStatistics().then(function(t){e.stat=t,e.statForDisplay=JSON.stringify(t,null,4)},function(e){sscAlert(e)}).then(function(){e.setLoading(!1)})}e.getStatistics=a,a()}]),app.controller("PanelAccountConfirmController",["$scope","$rootScope","$state","$stateParams","$timeout","UserService",function(e,t,n,o,r,a){function i(){e.vs.validate()&&(e.confirming=!0,a.editConfirm(t.data.labData.username,e.verificationCode).then(function(){e.confirming=!1,e.showMessage("    ","change password"===e.action?"      ":"edit account"===e.action?"        ":"").then(function(){return e.refreshUserData()}).then(function(){n.go("panel.account.summary")})},function(t){e.confirming=!1,sscAlert(t)}))}e.confirm=i,e.confirming=!1,e.action=o.action,e.setBackHandler(function(){"change password"===e.action?n.go("panel.account.password"):"edit account"===e.action?n.go("panel.account.edit"):n.go("panel.account.summary")}),e.setPageTitle(" "),e.vs=new ValidationSystem(e).field("verificationCode",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.numberCode(4)])}]),app.controller("PanelAccountEditController",["$scope","$rootScope","$state","$stateParams","$timeout","UserService",function(e,t,n,o,r,a){function i(){e.vs.validate()&&(e.editingAccount=!0,a.editAccount(e.user,e.vs.dictate).then(function(){n.go("panel.account.confirm",{action:"edit account"}),e.editingAccount=!1},function(t){e.editingAccount=!1,sscAlert(t)}))}e.editAccount=i,e.editingAccount=!1,e.user={labName:t.data.labData.labName,mobilePhoneNumber:t.data.labData.mobilePhoneNumber,phoneNumber:t.data.labData.phoneNumber,address:t.data.labData.address,postalCode:t.data.labData.postalCode,websiteAddress:t.data.labData.websiteAddress},e.setBackHandler(function(){n.go("panel.account.summary")}),e.setPageTitle("   "),e.vs=new ValidationSystem(e.user).field("labName",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.minLength(5)]).field("mobilePhoneNumber",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.mobilePhoneNumber()]).field("phoneNumber",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.phoneNumber()]).field("address",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.minLength(10)]).field("postalCode",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.integer(),ValidationSystem.validators.length(10)]).field("websiteAddress",[ValidationSystem.validators.notRequired(),ValidationSystem.validators.minLength(5),ValidationSystem.validators.url()])}]),app.controller("PanelAccountPasswordController",["$scope","$rootScope","$state","$stateParams","$timeout","UserService",function(e,t,n,o,r,a){function i(){e.vs.validate()&&(e.changingPassword=!0,a.editPassword(e.oldPassword,e.newPassword,e.vs.dictate).then(function(){n.go("panel.account.confirm",{action:"change password"}),e.changingPassword=!1},function(t){e.changingPassword=!1,sscAlert(t)}))}e.changePassword=i,e.changingPassword=!1,e.setBackHandler(function(){n.go("panel.account.summary")}),e.setPageTitle("  "),e.vs=new ValidationSystem(e).field("oldPassword",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.minLength(4)]).field("newPassword",[ValidationSystem.validators.notEmpty(),ValidationSystem.validators.minLength(4),function(t){if(e.newPasswordAgain&&e.newPasswordAgain!=t)return"      "}]).field("newPasswordAgain",[function(t){if(!e.newPassword)return!0},ValidationSystem.validators.notEmpty(),ValidationSystem.validators.minLength(4),function(t){if(e.newPassword!=t)return"      "}])}]),app.controller("PanelAccountSummaryController",["$scope","$rootScope","$state","$stateParams","$timeout",function(e,t,n,o,r){function a(){n.go("panel.account.edit")}function i(){n.go("panel.account.password")}e.editAccountData=a,e.changePassword=i,e.userDataForDisplay=[{label:" ",value:toPersianNumber(t.data.labData.labName)},{label:"   ",value:toPersianNumber(t.data.labData.mobilePhoneNumber)},{label:"  ",value:toPersianNumber(t.data.labData.phoneNumber)},{label:"",value:toPersianNumber(t.data.labData.address)},{label:" ",value:toPersianNumber(t.data.labData.postalCode)},{label:"  ",value:t.data.labData.websiteAddress},{label:" ",value:t.data.labData.username},{label:" ",value:persianDate(t.data.labData.subscriptionDate).format("L")}],e.setBackHandler(function(){n.go("panel.home")}),e.setPageTitle("  ")}]),app.controller("AdminController",["$scope","$rootScope","$state","$stateParams","$timeout","$interval","UserService",function(e,t,n,o,r,a,i){function s(t){r(function(){e.loading=t,e.loadingMessage=!1,t&&r(function(){e.loadingMessage=!0},1500)})}function l(e){d.pageTitle=e}function u(n){return function(){return n||e.setLoading(!0),i.refresh().then(function(o){t.data.adminData=o,n||e.setLoading(!1)})}}e.setLoading=s,e.setPageTitle=l,e.refreshUserData=u(!1),e.loading=e.loadingMessage=!1;var c=a(u(!0),6e4);e.$on("$distroy",function(){a.cancel(c)}),e.setMenuHandlers({goToMainPage:function(){n.go("admin.home")},goToLaboratoryPage:function(){n.go("admin.laboratory")},goToPatientPage:function(){n.go("admin.patient")},goToSmsPage:function(){n.go("admin.sms")},logout:function(){return s(!0),i.logout().then(function(){s(!1),n.go("lab.login")})}});var d={pageTitle:""};e.setHeaderHandlers(d),e.setFooterHandlers(!1)}]),app.controller("AnswerController",["$rootScope","$scope","$timeout","$window","$location","$state","$stateParams","HistoryService","UserService",function(e,t,n,o,r,a,i,s,l){function u(){f||(f=new Clipboard("#ja-shared-url-copy"),f.on("success",function(e){console.info("Success",e.action,e.text),e.clearSelection()}),f.on("error",function(e){console.info("Error",e.action,e.text)}))}function c(e){return function(t){switch(t.event){case"error":e.error=t.error;break;case"render start":delete e.error}e.loaded=["loaded pages","render start","render finish","error"].indexOf(e.model.state)>=0,d()}}function d(e){"function"==typeof e&&g.indexOf(e)<0&&(v&&e(),v||g.push(e)),!v&&t.answer&&(v=t.answer.files.reduce(function(e,t,n){return"pdf"!==t.material?e:e&&t.loaded},!0))&&g.forEach(function(e){e()})}t.nationalCode=i.p,t.postCode=i.n,t.pdfFileEventHandlerMaker=c,t.copySharedUrl=u;var f,m=r.absUrl();m=m.slice(0,m.indexOf("#")+2)+"answer"+m.slice(m.indexOf("?"));var p=i.previousState,h=i.previousStateData;t.setBackHandler(function(){a.is("answer.post")?"history"===p?(e.data.patientInfo=h.patientInfo,e.data.history=h.history,a.go(p,{nationalCode:t.nationalCode})):"panel.post"===p?(e.data.postCache=h.postCache,e.data.historyState=h.historyState,e.data.panelPostData=h.panelPostData,l.setUserSession(h.userSession),a.go(p)):a.go(p||"home.find"):a.go("answer.post")}),t.setMenuHandlers({viewFile:function(){a.go("answer.post")},saveFile:function(){a.go("answer.download")},shareFile:function(){f=void 0,t.sharedUrl=m,t.sharingViaSms="sms:;?&"+simpleQueryString.stringify({body:"!\n  "+t.answer.patientNam+"  :\n\n"+m}),t.sharingViaEmail="mailto:?&"+simpleQueryString.stringify({body:"!\n"+t.answer.patientName+"           :\n\n"+m,subject:"  "+t.answer.patientName}),t.sharingViaTelegram="https://telegram.me/share/url?"+simpleQueryString.stringify({text:"!\n"+t.answer.patientName+"           .",url:m}),a.go("answer.share")},printFile:function(){t.printing=!0,Promise.all([new Promise(function(e,t){n(e,1e3)}),new Promise(function(e,n){var o=t.answer.files.filter(function(e){return"pdf"===e.material});o.length?d(function(){Promise.all(o.map(function(e){return Promise.all(e.model.pages.map(function(e){return e.createDataURL(2400)})).then(function(t){e.dataUrls=t})})).then(e,n)}):e()})]).then(function(){n(function(){n(function(){o.print()})})},function(e){console.error("Coulldn't print:",e)}).then(function(){n(function(){t.printing=!1})})},getPrintingStatus:function(){return t.printing},goToLaboratory:function(){a.go("answer.laboratory")},goToLaboratoryWebsite:function(){var e=t.answer&&t.answer.lab&&t.answer.lab.websiteAddress;e&&(0===e.indexOf("http://")&&0===e.indexOf("https://")||(e="http://"+e),window.open(e,"_blank").focus())},labGetter:function(){return t.answer&&t.answer.lab||{}}}),t.setHeaderHandlers({paitentNameGetter:function(){return t.answer?t.answer.patientName:" "}}),t.setFooterHandlers({postDateGetter:function(){return t.answer?persianDate(t.answer.postDate).format("L"):" "},postCodeGetter:function(){return toPersianNumber(t.postCode)}}),a.go("answer.post"),t.loading=!0,s.loadAnswer(t.nationalCode,t.postCode).then(function(e){e.files.forEach(function(e){e.url="/answer/file/download?p="+t.nationalCode+"&n="+t.postCode+"&f="+e.serverName,e.urlWithoutContentType=e.url+"&t=false",e.type.indexOf("image")>=0?e.material="image":"application/pdf"===e.type&&(e.material="pdf")}),t.answer=e,t.answer.lab=t.answer.lab||{},t.labDataForDisplay=[{label:" ",value:toPersianNumber(t.answer.lab.name)},{label:" ",value:t.answer.lab?toPersianNumber(t.answer.lab.mobilePhoneNumber+" - "+t.answer.lab.phoneNumber):""},{label:"",value:toPersianNumber(t.answer.lab.address)},{label:" ",value:toPersianNumber(t.answer.lab.postalCode)},{label:"  ",value:t.answer.lab.websiteAddress}],t.loading=!1},function(e){t.loading=!1,t.setBackHandler(),t.setMenuHandlers(),t.setHeaderHandlers(),t.setFooterHandlers(),sscAlert(e),t.showMessage("    ","          .\n   .").then(function(){a.go("home.find")})});var g=[],v=!1}]),
app.controller("DeveloperController",["$scope","$rootScope","$state","$stateParams","$timeout","$interval","UserService",function(e,t,n,o,r,a,i){function s(){var e=getEnvironmentProperties(),t={};for(var n in e)e[n]&&(t[n]=e[n]);alert(JSON.stringify(t,null,4))}e.showEnvironmnetProperties=s}]),app.controller("HistoryController",["$rootScope","$scope","$state","$stateParams","$timeout",function(e,t,n,o,r){function a(e){n.go("answer",{p:e.nationalCode,n:e.postCode,previousState:"history",previousStateData:{patientInfo:t.patientInfo,history:t.history}})}if(t.postClicked=a,t.nationalCode=o.nationalCode,t.patientInfo=e.data.patientInfo,t.history=e.data.history,!t.patientInfo)return n.go("home.otp");t.setBackHandler(function(){n.go("home.otp")}),t.setMenuHandlers(!1),t.setHeaderHandlers({paitentName:t.patientInfo.fullName}),t.setFooterHandlers(!1),t.$on("$destroy",function(){delete e.data.patientInfo,delete e.data.history})}]),app.controller("HomeController",["$scope","$state",function(e,t){e.setMenuHandlers({goToHomeFind:function(){t.go("home.find")},goToHomeOtp:function(){t.go("home.otp")},goToLabLogin:function(){t.go("lab.login")},goToHomeAbout:function(){t.go("home.about",{previousState:t.current})},goToHomeContact:function(){t.go("home.contact",{previousState:t.current})}}),e.setHeaderHandlers(!1),e.setFooterHandlers(!0)}]),app.controller("LabController",["$scope","$state",function(e,t){e.setMenuHandlers({goToLabLogin:function(){t.go("lab.login")},goToLabRegister:function(){t.go("lab.register")},goToHomeFind:function(){t.go("home.find")},goToLabAbout:function(){t.go("lab.about",{previousState:t.current})},goToLabContact:function(){t.go("lab.contact",{previousState:t.current})}}),e.setHeaderHandlers(!1),e.setFooterHandlers(!0)}]),app.controller("MasterController",["$scope","$rootScope","$q","$window","$timeout","Config",function(e,t,n,o,r,a){function i(t){e.backHandler=t}function s(t){e.menuHandlers=t}function l(t){e.headerHandlers=t}function u(t){e.footerHandlers=t}function c(){angular.element("#ja-sidebar-menu").sidebar("setting","transition","overlay").sidebar("setting","mobileTransition","overlay").sidebar("toggle")}function d(t,o,r){e.modal={title:t,message:o,ok:r||""};var a=n.defer();return angular.element("#ja-informer-modal").modal({onHide:function(){a.resolve()}}).modal("show"),a.promise}function f(t,o,r,a,i,s){e.modal={title:t,message:o,yes:r||"",no:a||"",yesColor:i||"green",noColor:s||"blue"};var l=n.defer();return angular.element("#ja-confirm-modal").modal({onApprove:function(){l.resolve()},onDecline:function(){l.reject()}}).modal("show"),l.promise}function m(){a.developer_modal&&angular.element("#ja-developer-modal").modal("show")}e.setBackHandler=i,e.setMenuHandlers=s,e.setHeaderHandlers=l,e.setFooterHandlers=u,e.toggleMenu=c,e.showMessage=d,e.showConfirmMessage=f,e.showDeveloperModal=m,e.backHandler=void 0,e.menuHandlers=void 0,e.headerHandlers=void 0,e.footerHandlers=void 0,e.iconJs=o.iconJs}]),app.controller("PanelController",["$scope","$rootScope","$state","$stateParams","$timeout","$interval","UserService",function(e,t,n,o,r,a,i){function s(t){r(function(){e.loading=t,e.loadingMessage=!1,t&&r(function(){e.loadingMessage=!0},1500)})}function l(e){d.pageTitle=e}function u(n){return function(){return n||e.setLoading(!0),i.refresh().then(function(o){t.data.labData=o,n||e.setLoading(!1)},function(){})}}e.setLoading=s,e.setPageTitle=l,e.refreshUserData=u(!1),e.loading=e.loadingMessage=!1;var c=a(u(!0),6e4);e.$on("$distroy",function(){a.cancel(c)}),e.setMenuHandlers({goToMainPage:function(){n.go("panel.home")},goToUpdatePatient:function(){n.go("panel.patient")},goToSendResults:function(){n.go("panel.send")},goToResultsHistory:function(){n.go("panel.history")},goToChargeAccount:function(){n.go("panel.balance")},goToUserAccount:function(){n.go("panel.account.summary")},logout:function(){return s(!0),i.logout().then(function(){s(!1),n.go("lab.login")})}});var d={pageTitle:""};e.setHeaderHandlers(d),e.setFooterHandlers(!1)}]),app.controller("StartController",["$scope","$state",function(e,t){t.go(localStorage.startState||"home.find")}]),app.directive("pdf",["$timeout","$window","DynamicResourceLoader",function(e,t,n){return{restrict:"E",replace:!0,transclude:!0,scope:{src:"@ngSrc",model:"=?ngModel",width:"@",hideRendering:"@",eventHandler:"&"},template:["<div>",'    <div ng-if="loading" ng-transclude></div>','    <div ng-hide="loading" class="pdf-canvas-container"></div>',"</div>"].join(""),link:function(o,r,a){function i(e){d!=l()&&s()}function s(){if(o.model&&Array.isArray(o.model.pages))return m&&e(function(){o.loading=!0}),f.empty(),d=l(),h({event:"render start",desiredWidth:d}),Promise.all(o.model.pages.map(function(e){var t=e.createCanvas(d,2);return e.canvas=t.canvas,f.append(t.canvas),t.promise})).then(function(){function t(){h({event:"render finish"})}m?e(function(){o.loading=!1}).then(t):t()})}function l(){return r[0].offsetWidth||r[0].clientWidth}o.model=o.model||{};var u=!!o.model.pdf,c=o.model.pages&&Array.isArray(o.model.pages);if(!(u&&c||o.src))return void o.eventHandler({event:"error",error:"No URL has been specified."});var d,f=angular.element(r[0].querySelector(".pdf-canvas-container"));f.css("width",o.width||"100%");var m="true"===o.hideRendering,p="init",h=function(e){e.state=p,p=e.event,o.model&&(o.model.state=p);var t=o.eventHandler();"function"==typeof t&&t(e)};o.loading=!0;var g;g=u?Promise.resolve(o.model.pdf):new Promise(function(e,t){n("pdf.min.js",!1,function(){PDFJS?(h({event:"loading pdf"}),PDFJS.getDocument(o.src).then(function(t){o.model&&(o.model.pdf=t),h({event:"loaded pdf",pdf:t}),e(t)},function(e){t("Could not resolve pdf.")})):t("Could not resolve PDFJS.")})}),g=c?g.then(function(e){return o.model.pages}):g.then(function(e){return h({event:"loading pages"}),Promise.all(Array.range(1,e.numPages).map(function(t){return e.getPage(t)})).then(function(e){return e.forEach(function(e){e.createCanvas=function(t,n){n=n||1;var o=e.getViewport(1);o=e.getViewport(n*t/o.width);var r=document.createElement("canvas"),a=r.getContext("2d");r.width=o.width,r.height=o.height,r.style.width=t+"px",r.style.height=t*o.height/o.width+"px";var i={canvasContext:a,viewport:o};return{canvas:r,promise:e.render(i)}},e.createDataURL=function(t,n,o){var r=e.createCanvas(t);return new Promise(function(e,t){r.promise.then(function(){e(r.canvas.toDataURL(n,o))},function(e){t(e)})})}}),o.model&&(o.model.pages=e),h({event:"loaded pages",pages:e}),e},function(e){return Promise.reject("Could not resolve pages.")})}),g.then(function(t){s(),m||e(function(){o.loading=!1})}).catch(function(e){h({event:"error",error:e})}),t.addEventListener("resize",i),o.$on("$destroy",function(){t.removeEventListener("resize",i)})}}}]),app.directive("tableListContainer",["$timeout",function(e){return{restrict:"A",replace:!1,transclude:!1,scope:!1,compile:function(e,t){var n=e.find("table"),o=n.find("thead"),r=n.find("tbody"),a=t.tableListContainer;return a&&n.css("min-width",a),[{element:o,selector:"th"},{element:r,selector:"td"}].forEach(function(e){e.element.length&&e.element.find(e.selector).each(function(e){var t=angular.element(this);t.is("[fa]")?(t.addClass("nazanin"),t.addClass("ja-rtl"),t.removeAttr("fa")):t.addClass("ja-ltr"),t.is("[r]")&&(t.addClass("ja-align-right"),t.removeAttr("r")),t.is("[l]")&&(t.addClass("ja-align-left"),t.removeAttr("l")),t.is("[c]")&&(t.addClass("ja-align-center"),t.removeAttr("c")),t.is("[b]")&&(t.addClass("ja-bold"),t.removeAttr("b")),t.is("[i]")&&(t.addClass("ja-italic"),t.removeAttr("i"))})}),function(e,t,n){function o(){var e=r();e&&t.animate({scrollLeft:e},1e3)}function r(){return t[0].scrollWidth-t[0].clientWidth}t.is("[initialiy-right]")&&e.$watch(r,o)}}}}]),app.directive("zoomable",["$timeout",function(e){return{restrict:"A",replace:!1,transclude:!1,scope:{maxZoom:"&",top:"@",bottom:"@",right:"@",left:"@"},link:function(e,t,n){function o(){var e=d3.event,t=r(i),n=a(i),o=r(s),l=a(s),c=e.transform.k,d=e.transform.x,f=e.transform.y,m=(c-1)/2;d=Math.min(0,Math.max(d,t-o*c))+m*o,f=Math.min(0,Math.max(f,n-l*c))+m*l,e.transform.x=d-m*o,e.transform.y=f-m*l;var p="translate("+d+"px,"+f+"px) scale("+c+")";u.style("-webkit-transform",p).style("-moz-transform",p).style("-ms-transform",p).style("-o-transform",p).style("transform",p)}function r(e){return e[0].offsetWidth||e[0].clientWidth}function a(e){return e[0].offsetHeight||e[0].clientHeight}var i=t,s=angular.element(t[0].children[0]),l=d3.select(i[0]),u=d3.select(s[0]);l.style("position","fixed").style("top",(e.top||"0")+"px").style("bottom",(e.bottom||"0")+"px").style("right",(e.right||"0")+"px").style("left",(e.left||"0")+"px"),u.style("min-width",r(i)+"px").style("min-height",a(i)+"px");var c=d3.zoom().scaleExtent([1,function(){try{var t=e.maxZoom();if(!t)throw"No attribute max-zoom limit has been specified.";if("number"!=typeof t)throw"Attribute max-zoom limit is not a number.";if(!(t>0&&t<1e5))throw"Attribute max-zoom limit is out of range.";return t}catch(e){return console.error(e),1}}()]).duration(400).on("zoom",o);l.call(c)}}}]),app.filter("currencySeparator",function(){return function(e,t){e=String(e||""),t=t||",";for(var n="";e.length;)n=e.slice(-3)+n,e=e.slice(0,-3),e.length&&(n=t+n);return n}}),app.filter("emptyCheck",function(){return function(e,t){return void 0===e||null===e||""===e?t||"":String(e)}}),app.filter("toPersianDate",function(){return function(e,t){return persianDate(new Date(e)).format(t||"L")}}),app.filter("toPersianNumber",function(){return function(e){return toPersianNumber(String(e))}});